import{l as G,p as j,r as T,q as oe,s as _,h as y,o as f,t as u,u as a,w as v,v as g,b as I,x as B,y as S,c as D,a as R,z as E,A as Ie,C as H,g as b,D as ke,E as Ee,F as re,G as Te,H as Be,I as O,J as Se,K as De,L as W,M as X,N as se,O as Re,j as Ne,k as we,P as Ve,Q as Me}from"./index-CdEV5Lsj.js";import{_ as Y,a as Oe}from"./BasePage-aJlR_RJI.js";import{_ as ie}from"./ULabel.vue_vue_type_script_setup_true_lang-DmdMPZfT.js";import{_ as x,b as ee,a as P,u as Pe,O as Ge}from"./index-DruWBKkm.js";import{g as je}from"./helper.service-Dk93koq0.js";const _e=1024*1024;function He(U){return(U.size/_e).toFixed(2)}const qe="UFile",le={file:{base:"{ULink} flex items-center",variants:{size:{sm:"gap-0.5",md:"gap-1",lg:"gap-1.5"}}},body:{base:"flex items-center",variants:{size:{sm:"gap-1",md:"gap-1.5",lg:"gap-2"}}},fileImage:"rounded-sm max-w-7",fileIcon:{base:"{UIcon}",defaults:{size:{sm:"xs",md:"sm",lg:"md"}}},fileLabel:"{ULink}",removeIcon:{base:"{UIcon}",defaults:{size:{sm:"2xs",md:"xs",lg:"sm"}}},defaults:{size:"md",fileIcon:"description",removeIcon:"close"}},Ze=["alt","src"],Je=G({inheritAttrs:!1,__name:"UFile",props:j({url:{},imageUrl:{},label:{},size:{},id:{},removable:{type:Boolean},config:{},dataTest:{}},{...H(le,qe),label:""}),emits:["remove"],setup(U,{emit:p}){const A=U,r=p,z=T(!1),h=A.id||oe();function t(){r("remove",A.id)}function d(){z.value=!0}function c(){z.value=!1}const{getDataTest:F,config:o,fileAttrs:C,bodyAttrs:l,fileIconAttrs:m,fileLabelAttrs:$,fileImageAttrs:N,removeIconAttrs:w}=_(le);return(s,V)=>(f(),y(x,u({href:s.url},a(C),{"data-test":a(F)()}),{default:v(()=>[g(s.$slots,"left",{file:{elementId:a(h),label:s.label,url:s.url,imageUrl:s.imageUrl}}),g(s.$slots,"default",{file:{elementId:a(h),label:s.label,url:s.url,imageUrl:s.imageUrl}},()=>[I("div",B(S(a(l))),[s.imageUrl?(f(),D("img",u({key:0,alt:s.label,src:s.imageUrl},a(N)),null,16,Ze)):(f(),y(ee,u({key:1,internal:"",interactive:"",color:"gray",name:a(o).defaults.fileIcon},a(m),{onFocus:d,onBlur:c}),null,16,["name"])),R(x,u({label:s.label,size:s.size,color:"gray",dashed:""},a($)),null,16,["label","size"])],16)]),g(s.$slots,"right",{file:{elementId:a(h),label:s.label,url:s.url,imageUrl:s.imageUrl}},()=>[s.removable?(f(),y(ee,u({key:0,internal:"",interactive:"",color:"gray",name:a(o).defaults.removeIcon},a(w),{"data-test":a(F)("remove-item"),onClick:Ie(t,["stop","prevent"])}),null,16,["name","data-test"])):E("",!0)])]),_:3},16,["href","data-test"]))}}),Ke="UFiles",ae={filesLabel:"{ULabel}",items:"flex flex-col gap-1.5",item:"{UFile} flex",defaults:{size:"md",labelAlign:"top"}},Qe=G({inheritAttrs:!1,__name:"UFiles",props:j({fileList:{},label:{},labelAlign:{},description:{},size:{},removable:{type:Boolean},config:{},dataTest:{}},{...H(ae,Ke),fileList:()=>[],label:""}),emits:["remove"],setup(U,{emit:p}){const A=U,r=p,z=b(()=>A.fileList.map(o=>{if(o instanceof File)return{id:ke(),label:o.name||"",url:URL.createObjectURL(o),imageUrl:o.type.includes("image")?URL.createObjectURL(o):void 0}}));function h(o){r("remove",o)}const{getDataTest:t,filesLabelAttrs:d,itemsAttrs:c,itemAttrs:F}=_(ae);return(o,C)=>(f(),y(ie,u({label:o.label,description:o.description,size:o.size,align:o.labelAlign},a(d)),{label:v(()=>[g(o.$slots,"label",{label:o.label})]),default:v(()=>[I("div",B(S(a(c))),[g(o.$slots,"default",{},()=>[(f(!0),D(re,null,Ee(z.value,(l,m)=>(f(),y(Je,u({id:l==null?void 0:l.id,key:l==null?void 0:l.id,label:l==null?void 0:l.label,url:l==null?void 0:l.url,"image-url":l==null?void 0:l.imageUrl,size:o.size,removable:o.removable,ref_for:!0},a(F),{"data-test":a(t)(`item-${m}`),onRemove:h}),{left:v(({file:$})=>[g(o.$slots,"left",{file:$,index:m})]),right:v(({file:$})=>[g(o.$slots,"right",{file:$,index:m})]),_:2},1040,["id","label","url","image-url","size","removable","data-test"]))),128))])],16)]),_:3},16,["label","description","size","align"]))}}),te="UInputFile",We=["textContent"],Xe=["id","disabled","accept","multiple"],Ye=G({inheritAttrs:!1,__name:"UInputFile",props:j({modelValue:{},label:{},description:{},error:{},labelAlign:{},size:{},maxFileSize:{},allowedFileTypes:{},multiple:{type:Boolean},disabled:{type:Boolean},id:{},config:{},dataTest:{}},{...H(O,te),modelValue:()=>[],allowedFileTypes:()=>[],label:""}),emits:["update:modelValue","error"],setup(U,{expose:p,emit:A}){const r=U,z=A,{tm:h}=Te(),t=T(null),d=T(null),c=T(""),F=r.id||oe(),o=h(te),C=b(()=>Be({},O.i18n,o,r.config.i18n)),l=b({get:()=>r.modelValue,set:e=>{const i=r.multiple?[]:null;z("update:modelValue",e||i)}}),m=b(()=>c.value||r.error),$=b(()=>r.allowedFileTypes.map(e=>e.replace(".",""))),N=b(()=>r.allowedFileTypes.map(e=>e.startsWith(".")?e:`.${e}`)),w=b(()=>N.value.join(",")),s=b(()=>{var e;return Array.isArray(l.value)?!!((e=l.value)!=null&&e.length):!!l.value}),V=b(()=>Array.isArray(l.value)?l.value:l.value?[l.value]:[]);Se(()=>{t.value&&(t.value.addEventListener("dragover",J),t.value.addEventListener("dragleave",K))}),De(()=>{t.value&&(t.value.removeEventListener("dragover",J),t.value.removeEventListener("dragleave",K))}),W(()=>r.multiple,ne),W(m,()=>z("error",m.value));function ne(){r.multiple&&(Array.isArray(l.value)||(l.value=l.value?[l.value]:[]))}function q(e){return e.filter(i=>i instanceof File&&!V.value.some(n=>n instanceof File&&n.name===i.name))}function Z(e){const i=He(e),n=$.value.length?$.value.some(Ce=>e.type.includes(Ce)):!0,k=Number(i)<=r.maxFileSize;if(!n){c.value=C.value.formatError;return}if(!k&&r.maxFileSize){c.value=C.value.sizeError;return}c.value=""}function ue(e){const i=e.target;if(i&&i.files){const n=i.files[0];if(Z(n),m.value){M();return}r.multiple?(Array.isArray(l.value)||(l.value=l.value instanceof File?[l.value]:[]),l.value=[...l.value,...q(Array.from(i.files).filter(k=>k instanceof File))]):l.value=n instanceof File?n:null,d.value&&(d.value.value="")}}function M(){l.value=null,d.value&&(d.value.value="")}function J(e){e.preventDefault(),t.value&&L.value&&L.value.dropzoneHover&&t.value.classList.add(...L.value.dropzoneHover.split(" "))}function K(e){e.preventDefault(),t.value&&L.value&&L.value.dropzoneHover&&t.value.classList.remove(...L.value.dropzoneHover.split(" "))}function de(e){e.preventDefault();let i=[];e.dataTransfer&&e.dataTransfer.items?i=[...e.dataTransfer.items].filter(n=>n.kind==="file").map(n=>n.getAsFile()).filter(n=>!n):e.dataTransfer&&e.dataTransfer.files&&(i=[...e.dataTransfer.files]),i.length&&i.filter(n=>!n).forEach(Z),Re(()=>{if(m.value||!i.length){M();return}const n=i.filter(k=>!k);l.value=r.multiple?[...Array.isArray(l.value)?l.value:[],...q(n)]:n[0]})}function me(e){Array.isArray(l.value)&&(l.value=l.value.filter(i=>i.name!==e))}const fe=b(()=>({error:!!m.value,label:!!r.label}));p({error:m});const{getDataTest:Q,config:L,inputLabelAttrs:pe,chooseFileButtonAttrs:ce,dropzoneAttrs:ve,descriptionTopAttrs:ge,descriptionBottomAttrs:be,contentAttrs:ye,clearButtonAttrs:Fe,placeholderAttrs:Ae,inputAttrs:ze,fileListAttrs:he,buttonsAttrs:Ue,chooseFileButtonErrorAttrs:$e,clearButtonErrorAttrs:Le}=_(O,fe);return(e,i)=>(f(),y(ie,u({for:a(F),size:e.size,label:e.label,error:m.value,align:e.labelAlign,disabled:e.disabled,description:e.description,interactive:""},a(pe)),{label:v(()=>[g(e.$slots,"label",{label:e.label})]),default:v(()=>[I("div",u({ref_key:"dropZoneRef",ref:t,ondrop:de},a(ve)),[a(X)(e.$slots.top)?(f(),y(Y,u({key:0,size:e.size},a(ge)),{default:v(()=>[g(e.$slots,"top")]),_:3},16,["size"])):E("",!0),I("div",B(S(a(ye))),[g(e.$slots,"left"),s.value?(f(),y(Qe,u({key:1,size:e.size},a(he),{"file-list":V.value,removable:e.multiple&&!e.disabled,onRemove:me}),{right:v(({file:n})=>[g(e.$slots,"right",{file:n})]),_:3},16,["size","file-list","removable"])):(f(),D("span",u({key:0},a(Ae),{textContent:se(C.value.noFile)}),null,16,We)),I("div",B(S(a(Ue))),[Array.isArray(l.value)||!l.value?(f(),D(re,{key:0},[R(P,u({filled:"",tabindex:"-1",for:a(F),tag:"label",variant:"thirdary","right-icon":a(L).defaults.chooseFileIcon,label:C.value.uploadFile,disabled:e.disabled},m.value?a($e):a(ce),{"data-test":a(Q)("upload")}),null,16,["for","right-icon","label","disabled","data-test"]),I("input",u({id:a(F),ref_key:"fileInputRef",ref:d,type:"file",disabled:e.disabled,accept:w.value,multiple:e.multiple},a(ze),{onChange:ue}),null,16,Xe)],64)):E("",!0),s.value&&!e.disabled?(f(),y(P,u({key:1,round:"",square:"",filled:"",variant:"thirdary",disabled:e.disabled,"left-icon":a(L).defaults.clearIcon},m.value?a(Le):a(Fe),{"data-test":a(Q)("clear"),onClick:M}),null,16,["disabled","left-icon","data-test"])):E("",!0)],16)],16),a(X)(e.$slots.bottom)?(f(),y(Y,u({key:1,size:e.size},a(be)),{default:v(()=>[g(e.$slots,"bottom")]),_:3},16,["size"])):E("",!0)],16)]),_:3},16,["for","size","label","error","align","disabled","description"]))}}),ol={__name:"Page",setup(U){const p=Pe(),A=T(!1),r=Ne({logoFile:null}),z=b(()=>{var t;return!((t=r.logoFile)!=null&&t.name)});we(async()=>{p.hasCompanyData||await p.getCompany();const t=p.company.logo.logoUrl;r.logoFile=p.company.logo.logoFile||await je(t)});async function h(t){if(!Me(r.logoFile,p.company.logo.logoFile)){const c=new FormData;c.append("logo",r.logoFile),await p.updateCompanyLogo(c),p.company.logo.logoFile=r.logoFile}t()}return(t,d)=>{const c=P,F=Ye;return f(),y(Oe,{group:t.$t("group.company"),"group-step":a(Ge)*2,title:t.$t("title.companyLogo"),description:t.$t("description.companyLogo"),step:3,"prevent-next":z.value,prev:{name:"GettingStarted/Company/Step2"},next:{name:"GettingStarted/Company/Step4"},skip:{name:"GettingStarted/Company/Step4"},onContinue:h},{default:v(()=>[R(F,{modelValue:r.logoFile,"onUpdate:modelValue":d[0]||(d[0]=o=>r.logoFile=o),label:t.$t("label.uploadLogo"),"allowed-file-types":["jpeg","jpg","png"],"max-file-size":20,onError:d[1]||(d[1]=o=>A.value=!!o)},{top:v(()=>[Ve(se(t.$t("description.uploadFile")),1)]),left:v(()=>[R(c,{class:"-rotate-45 !bg-white cursor-default",color:A.value?"red":"brand",variant:"thirdary",icon:"paperclip",tabindex:"-1",size:"sm",round:"",square:"",filled:""},null,8,["color"])]),_:1},8,["modelValue","label"])]),_:1},8,["group","group-step","title","description","prevent-next"])}}};export{ol as default};
