var blendClientLimits={refs:{primary:"#clientLimitNotification",form:"#clientLimitNotification form",dismiss:"#btnClientLimitNotificationDismiss",dontshow:"#btnClientLimitNotificationDontShowAgain"},init:function(){var t=blendClientLimits;$(t.refs.form).submit(function(e){e.preventDefault(),t.go($(this))}),$(t.refs.dismiss).click(function(e){e.preventDefault(),t.dismiss("clientlimitdismiss")}),$(t.refs.dontshow).click(function(e){e.preventDefault(),t.dismiss("clientlimitdontshowagain")})},dismiss:function(e){$(this.refs.primary).fadeOut(),WHMCS.http.jqClient.post(window.location.href,e+"=1&name="+$(this.refs.primary).find(".panel-title span").html())},go:function(t){var e=t.data("fetchUrl"),n=t.find('button[type="submit"]'),a=n.html();n.css("width",n.css("width")).prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i>'),WHMCS.http.jqClient.post(e,t.serialize(),function(e){t.find(".input-license-key").val(e.license_key),t.find(".input-member-data").val(e.member_data),t.off("submit").submit(),n.html(a).removeProp("disabled")},"json")}},blendGlobal=($(document).ready(blendClientLimits.init),{refs:{frmNotes:"#frmMyNotes",modalNotes:"#modalMyNotes"},init:function(){var t=blendGlobal;$(t.refs.frmNotes).submit(function(e){e.preventDefault(),$(t.refs.modalNotes).modal("hide"),WHMCS.http.jqClient.post($(this).attr("action"),$(this).serialize())}),$("div.modal").on("shown.bs.modal",function(){var e=jQuery(this).find("input:not(input[type=checkbox],input[type=radio],input[type=hidden]),button.btn-primary");0<e.length&&$(e).first().focus()}),lightbox.init()}}),blendIntelliSearch=($(document).ready(blendGlobal.init),{activeSearch:!1,typingTimer:null,refs:{body:"body",form:"#intelliSearchForm",value:"#inputIntelliSearchValue",close:"#btnIntelliSearchClose",results:"#intelligentSearchResults",searchResults:"#intelligentSearchResults .search-results",resultheadings:"#intelligentSearchResults h5",expand:"#intelliSearchExpand",realtime:"#intelliSearchRealtime",hideinactive:"#intelliSearchHideInactiveSwitch",expandbtn:"#intelligentSearchResults .search-more-results",searchMoreTpl:'.search-more-results[data-type="placeholder"]'},init:function(){var n=blendIntelliSearch;$(n.refs.value).focus(function(e){n.inputExpand()}),$(n.refs.value).keyup(function(){n.inputKeyUp()}),$(n.refs.form+" form").submit(function(e){e.preventDefault(),n.search()}),$(document).keyup(function(e){27===e.keyCode&&$("#intelliSearchForm").hasClass("active")&&n.close()}),$(n.refs.body).click(function(e){$(n.refs.form).hasClass("active")&&!$(e.target).closest(n.refs.form+","+n.refs.results).length&&n.close()}),$(n.refs.close).click(function(e){n.close()}),$(n.refs.realtime).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"token="+csrfToken+"&autosearch="+t)}),$(n.refs.hideinactive).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(e,t){t=t?1:0;$("#intelliSearchHideInactive").attr("value",t),n.search()}),$(n.refs.resultheadings).click(function(e){n.toggleResultSet($(this))}),$(blendIntelliSearch.refs.results+" .collapse-toggle").click(function(e){e.preventDefault(),blendIntelliSearch.toggleAllResultSets()}),$(document).on("click",blendIntelliSearch.refs.expandbtn,function(e){e.preventDefault(),blendIntelliSearch.expandResults($(this),$(this).data("type"))})},inputExpand:function(){var e,t,n=$(this.refs.form);n.data("expanded")||(t=(e=n.offset()).left,e.left-=100,n.data("expanded",!0).data("leftpos",e.left).css({position:"absolute",top:e.top,left:t}).animate({left:e.left},200,function(){$("#btnNavbarToggle").is(":visible")?n.delay(10).queue(function(e){$(this).addClass("active full-width"),e()}):n.addClass("active").css("width",$(window).width()-e.left-5)}),$(this.refs.value).val()&&$(this.refs.results).slideDown())},inputKeyUp:function(){clearTimeout(this.typingTimer),3<=$(this.refs.value).val().replace(/\s/g,"").length&&$("#intelliSearchRealtime").is(":checked")&&(this.typingTimer=setTimeout(this.search,750))},showLoader:function(){$(this.refs.form).find(".loader").removeClass("fa-search").addClass("fa-spinner fa-spin")},endLoader:function(){$(this.refs.form).find(".loader").addClass("fa-search").removeClass("fa-spinner fa-spin")},resetResults:function(){$(this.refs.searchResults).find("h5").hide().end().find("ul li:not(.template)").remove().end().find(".search-more-results").remove()},getResultTypes:function(){var t=[];return $(".search-results ul").each(function(e){t.push($(this).data("type"))}),t},getResultTarget:function(e){return $(this.refs.searchResults+' ul[data-type="'+e+'"]')},getNumResults:function(e){return this.getResultTarget(e).find("li:not(.template)").length},getTotalResults:function(){return $(this.refs.searchResults+" ul").find("li:not(.template)").length},getTemplateByType:function(e){e=this.getResultTarget(e).find("li.template").clone();return e.removeClass("template"),e},renderResults:function(n,e){var a,t;0!=e.length&&(a=this.getTemplateByType(n),$.each(e,function(e,t){t="string"==typeof t?"<li>"+t+"</li>":blendIntelliSearch.mergeResultData(a.clone(),t);blendIntelliSearch.addResult(n,t)}),t=this.getNumResults(n),this.getResultTarget(n).prev("h5").show().find(".count").html(t),e[0].totalResults>t)&&(e=e[0].totalResults-t,this.showExpand(n,e))},showExpand:function(e,t){$(this.refs.expand).val()!=e&&((cloneRow=$(this.refs.searchMoreTpl).clone()).attr("data-type",e),cloneRow.removeClass("hidden"),stringValue=(stringValue=cloneRow.html()).replace(":count",t),cloneRow.html(stringValue),this.addResult(e,cloneRow))},addResult:function(e,t){this.getResultTarget(e).append(t)},mergeResultData:function(e,t){return str=e.html(),$.each(t,function(e,t){str=str.replace(new RegExp("\\["+e+"\\]","g"),t)}),e.html(str)},search:function(e){var a=blendIntelliSearch;a.activeSearch||(a.activeSearch=!0,a.showLoader(),$(a.refs.results).is(":visible")||$(a.refs.results).slideDown(),$(a.refs.expand).val(e),WHMCS.http.jqClient.jsonPost({url:$(a.refs.form+" form").attr("action"),data:$(a.refs.form+" form").serialize(),success:function(n){$(a.refs.expand).val()||a.resetResults(),$.each(a.getResultTypes(),function(e,t){a.renderResults(t,n[t])}),a.searchComplete(!0)},warning:function(e){$(a.refs.results).find(".search-warning").find(".warning-msg").html(e),a.searchComplete(!1,".search-warning")},error:function(e){a.searchComplete(!1,".error")},fail:function(e){a.searchComplete(!1,".session-expired")}}))},searchComplete:function(e,t){e&&(e=this.getTotalResults(),$(this.refs.results).find(".search-result-count").html(e),t=0===e?".search-no-results":".search-results"),$(this.refs.results).find(".outcome").not(t).hide(),$(this.refs.results).find(t).is(":visible")||$(this.refs.results).find(t).fadeIn(),this.endLoader(),this.activeSearch=!1},expandResults:function(e,t){e.remove(),this.search(t)},close:function(){var t=$(this.refs.form);$(this.refs.results).slideUp(),t.css({width:"",left:$(this.refs.form).data("leftpos")}).removeClass("active full-width").delay(100).queue(function(e){t.css({position:"",top:"",left:""}),e()}).data("expanded",!1),$(".logo").focus(),clearTimeout(this.typingTimer)},toggleResultSet:function(e){var t=e.next("ul"),t=(t.is(":visible")?(t.slideUp(),e.addClass("collapsed")):(t.slideDown(),e.removeClass("collapsed")),$(this.refs.results+" h5:visible").length),e=$(this.refs.results+" h5:visible:not(.collapsed)").length,n=$(this.refs.results+" .collapse-toggle");0==e?n.html(n.data("lang-expand")):t==e&&n.html(n.data("lang-collapse"))},toggleAllResultSets:function(){var e=$(this.refs.results+" h5:visible:not(.collapsed)").length,t=$(this.refs.results+" .collapse-toggle");0==e?($(this.refs.results+" ul").slideDown(),$(this.refs.results+" h5").removeClass("collapsed"),t.html(t.data("lang-collapse"))):($(this.refs.results+" ul").slideUp(),$(this.refs.results+" h5").addClass("collapsed"),t.html(t.data("lang-expand")))}}),blendNav=($(document).ready(blendIntelliSearch.init),{refs:{toggle:"#btnNavbarToggle",navbar:".navigation",collapse:".navigation .navbar-collapse",collapseMenuItem:".navigation .navbar-collapse li.has-dropdown > a",collapseMenuListItem:".navigation .navbar-collapse li.has-dropdown > ul li:not(.expand) > a",backdrop:"#nav-backdrop"},init:function(){var t=blendNav;$(t.refs.toggle).click(function(e){e.preventDefault(),t.toggleNavbar()}),$(t.refs.collapseMenuItem).click(function(e){$(t.refs.toggle).is(":visible")&&(e.preventDefault(),$(this).parent("li").toggleClass("expanded"))}),$(t.refs.collapseMenuListItem).click(function(){t.toggleNavbar()}),t.fixNavWidths()},toggleNavbar:function(){var e;$(this.refs.collapse).is(":visible")?($(this.refs.collapse).hide(),$(this.refs.backdrop).remove(),$("html, body").css("overflow","auto"),$(this).removeClass("active")):(e=$(this.refs.navbar).offset().top+45,$(this.refs.collapse).css({top:e,height:$(window).height()-e}).show(),$(document.createElement("div")).attr("id","nav-backdrop").addClass("modal-backdrop nav-modal-backdrop").css("opacity","0.5").css("position","absolute").css("top",e).appendTo("body"),$("html, body").css("overflow","hidden"),$(this).addClass("active"))},fixNavWidths:function(){1260<=$(window).width()&&$(this.refs.collapse+" > ul > li:not(.bt)").each(function(e){$(this).css("width",$(this).width()+4)})}}),blendSidebar=($(document).ready(blendNav.init),{refs:{sidebar:"#sidebar",content:"#contentarea",opener:"#sidebarOpener",closer:"#sidebarClose",collapse:".sidebar-collapse",collapseExpand:"#sidebarCollapseExpand"},init:function(){var t=blendSidebar;$(t.refs.opener).click(function(e){e.preventDefault(),$(this).fadeOut(),$(t.refs.content).removeClass("sidebar-minimized"),$(t.refs.sidebar).delay(400).fadeIn("fast"),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=maxsidebar")}),$(t.refs.closer).click(function(e){e.preventDefault(),$(t.refs.sidebar).fadeOut("fast",function(){$(t.refs.content).addClass("sidebar-minimized"),$(t.refs.opener).fadeIn()}),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=minsidebar")}),$(t.refs.collapseExpand).click(function(e){e.preventDefault(),$(this).toggleClass("expanded"),$(t.refs.collapse).slideToggle()})}}),blendSlidetray=($(document).ready(blendSidebar.init),{refs:{opener:'*[data-toggle="slide-tray"]',close:'button[data-dismiss="slide-tray"]',backdrop:"slide-tray-backdrop",tray:".slide-tray"},init:function(){var n=blendSlidetray;$(n.refs.opener).click(function(e){e.preventDefault();e=$(this).data("target");$("#"+n.refs.backdrop).length||$(document.createElement("div")).attr("id",n.refs.backdrop).addClass("modal-backdrop nav-modal-backdrop").css("opacity","0.5").css("position","absolute").css("top",0).appendTo("body"),$("#"+n.refs.backdrop).fadeIn(),$("html, body").css("overflow","hidden"),$(e).show(),$(e).hasClass("right")?($(e).css("right",-1*$(e).outerWidth()),$(e).animate({right:0},200)):($(e).css("left",-1*$(e).outerWidth()),$(e).animate({left:0},200))}),$(n.refs.close).click(function(e){e.preventDefault();var t=$(this).closest(n.refs.tray);$(t).hasClass("right")?$(t).animate({right:-1*$(t).outerWidth()},200,function(){$(t).hide(),$("#"+n.refs.backdrop).fadeOut("",function(){$("html, body").css("overflow","auto")})}):$(t).animate({left:-1*$(t).outerWidth()},200,function(){$(t).hide(),$("#"+n.refs.backdrop).fadeOut("",function(){$("html, body").css("overflow","auto")})})})}});function toggleadvsearch(){"hidden"==document.getElementById("searchbox").style.visibility?document.getElementById("searchbox").style.visibility="":document.getElementById("searchbox").style.visibility="hidden"}function populate(e){if(d=document.getElementById("searchfield"),v=e.options[e.selectedIndex].value,d){var t=new Array;if(t.clients=["Client ID","Client Name","Company Name","Email Address","Address 1","Address 2","City","State","Postcode","Country","Phone Number","CC Last Four","Notes"],t.orders=["Order ID","Order #","Client Name","Order Date","Amount"],t.services=["Service ID","Domain","Client Name","Product","Billing Cycle","Next Due Date","Status","Username","Dedicated IP","Assigned IPs","Subscription ID","Notes"],t.domains=["Domain ID","Domain","Client Name","Registrar","Expiry Date","Status","Subscription ID","Notes"],t.invoices=["Invoice #","Client Name","Line Item","Invoice Date","Due Date","Date Paid","Total Due","Status"],t.tickets=["Ticket #","Tag","Subject","Client Name","Email Address"],d.options.length=0,cur=t[e.options[e.selectedIndex].value]){d.options.length=cur.length;for(var n=0;n<cur.length;n++)d.options[n].text=cur[n],d.options[n].value=cur[n];"services"!=v&&"domains"!=v&&"clients"!=v||(document.getElementById("searchfield").selectedIndex=1)}}}function scrollToGatewayInputError(){var e=jQuery(".gateway-errors,.assisted-cc-input-feedback").first();(e.closest("form")||jQuery("form").first()).find('button[type="submit"],input[type="submit"]').prop("disabled",!1).removeClass("disabled").find("i.fas,i.far,i.fal,i.fab").removeAttr("class").addClass("fas fa-arrow-circle-right").find("span").toggle(),e.length&&elementOutOfViewPort(e[0])&&jQuery("html, body").animate({scrollTop:e.offset().top-50},500)}function elementOutOfViewPort(e){var e=e.getBoundingClientRect(),t={};return t.top=e.top<0,t.left=e.left<0,t.bottom=e.bottom>(window.innerHeight||document.documentElement.clientHeight),t.right=e.right>(window.innerWidth||document.documentElement.clientWidth),t.any=t.top||t.left||t.bottom||t.right,t.any}function showCheckoutError(e,t=null){jQuery(".alert-danger").hide();(t=t||jQuery([".checkout-error-feedback","#existingLoginMessage",".gateway-errors",".assisted-cc-input-feedback"].join(", ")).first()).length&&t.html(e).slideDown("fast")}$(document).ready(blendSlidetray.init),function(e){"object"!=typeof e.WHMCS&&(e.WHMCS={hasModule:function(e){return typeof WHMCS[e]!=="undefined"&&Object.getOwnPropertyNames(WHMCS[e]).length>0},loadModule:function(e,t){if(this.hasModule(e))return;WHMCS[e]={};if(typeof t==="function")t.apply(WHMCS[e]);else for(var n in t)if(t.hasOwnProperty(n)){WHMCS[e][n]={};t[n].apply(WHMCS[e][n])}}})}(window),jQuery(document).ready(function(){jQuery(document).on("click",".disable-on-click",function(){var e;jQuery(this).addClass("disabled"),jQuery(this).hasClass("spinner-on-click")&&(e=$(this).find("i.fas,i.far,i.fal,i.fab"),jQuery(e).removeAttr("class").addClass("fas fa-spinner fa-spin"))}).on("click","#openTicketSubmit.disabled",function(){return!1})}),WHMCS.hasModule("adminUtils")||WHMCS.loadModule("adminUtils",function(){return this.getAdminRouteUrl=function(e){return whmcsBaseUrl+"/index.php?rp="+adminBaseRoutePath+e},this.normaliseStringValue=function(e){return e?e.toLowerCase().replace(/\s/g,"-"):""},this.generatePassword=function(e){var t=this.getPasswordCharacterSet();var n="";for(var a=0;e>a;a++)n+=t[this.randomInt(t.length)];return n},this.getPasswordCharacterSet=function(){var e="0123456789"+"abcdefghijklmnopqrstuvwxyz"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"!#$%()*+,-.:;=@_|{ldelim}{rdelim}~";var t=[];for(var n=0;e.length>n;n++){var a=e.charCodeAt(n);if(55296>a||a>=57344){var i=e.charAt(n);if(t.indexOf(i)==-1)t.push(i);continue}if(56320>a?e.length>n+1:false){var r=e.charCodeAt(n+1);if(r>=56320?57344>r:false){var i=e.substring(n,n+2);n++;if(t.indexOf(i)==-1)t.push(i);continue}}throw new Error("Invalid UTF-16")}return t},this.randomInt=function(e){var t=this.randomIntMathRandom(e);t=(t+this.randomIntBrowserCrypto(e))%e;return t},this.randomIntMathRandom=function(e){var t=Math.floor(Math.random()*e);if(0>t||t>=e)throw new Error("Arithmetic exception");return t},this.randomIntBrowserCrypto=function(e){var t=null;if("crypto"in window)t=crypto;else if("msCrypto"in window)t=msCrypto;else return 0;if(!("getRandomValues"in t)||!("Uint32Array"in window)||typeof Uint32Array!="function")t=null;if(t==null)return 0;var n=new Uint32Array(1);do{t.getRandomValues(n)}while(n[0]-n[0]%e>4294967296-e);return n[0]%e},this.ensureElementHasId=function(e,t){e=jQuery(e);if(typeof e.attr("id")==="undefined")e.attr("id",this.generateUniqueIdentifier(t));return this},this.generateUniqueIdentifier=function(e){let t=Math.random().toString(36).replace("0.",e||"x_");if(this.generatedIds.includes(t))return this.generateUniqueIdentifier(e);this.generatedIds.push(t);return t},this.generatedIds=[],this.clearLocalStorage=function(e){if(typeof Storage==="undefined")return;if(e.data("noClear")===true)return;localStorage.removeItem(e.data("localStorageId"))},this}),function(e){WHMCS.hasModule("http")||WHMCS.loadModule("http",e)}({jqClient:function(){return _getSettings=function(e,t,n,a){return"object"==typeof e?e:("function"==typeof t&&(n=t,t=null),{url:e,data:t,success:n,dataType:a})},this.get=function(e,t,n,a){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,n,a),{type:"GET"}))},this.post=function(e,t,n,a){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,n,a),{type:"POST"}))},this.jsonGet=function(n){n=n||{},this.get(n.url,n.data,function(e){e.warning?(console.log("[WHMCS] Warning: "+e.warning),"function"==typeof n.warning&&n.warning(e.warning)):e.error?(console.log("[WHMCS] Error: "+e.error),"function"==typeof n.error&&n.error(e.error)):"function"==typeof n.success&&n.success(e)},"json").error(function(e,t){console.log("[WHMCS] Error: "+t),"function"==typeof n.fail&&n.fail(t)}).always(function(){"function"==typeof n.always&&n.always()})},this.jsonPost=function(a){a=a||{},this.post(a.url,a.data,function(e,t,n){e.warning?(console.log("[WHMCS] Warning: "+e.warning),"function"==typeof a.warning&&a.warning(e.warning,e,n)):e.error?(console.log("[WHMCS] Error: "+e.error),"function"==typeof a.error&&a.error(e.error,e,n)):"function"==typeof a.success&&a.success(e,n)},"json").fail(function(e,t,n){console.log("[WHMCS] Fail: "+t),"function"==typeof a.fail&&a.fail(t,e.responseJSON,e)}).always(function(e,t,n){"function"==typeof a.always&&a.always(e)})},this},client:function(){var i=this;return _beforeRequest=function(e){return void 0===e.type&&(e.type="GET"),e},this.request=function(e){return e=_beforeRequest(e||{}),jQuery.ajax(e)},jQuery.each(["get","post","put","delete"],function(e,t){var n,a;i[t]=(n=t,a=i,function(e){return(e=e||{}).type=n.toUpperCase(),a.request(e)})}),this}}),WHMCS.hasModule("ui")||WHMCS.loadModule("ui",{confirmation:function(){var t=[];return this.register=function(e){return t.indexOf(e=void 0===e?"[data-toggle=confirmation]":e)<0&&t.push(e),jQuery(e).confirmation({rootSelector:e}),t},this},dataTable:function(){return this.tables={},this.register=function(){var n=this;jQuery("table.data-driven").each(function(e,t){n.getTableById(t.id,void 0)})},this.getTableById=function(e,n){var t,a,i=this,r=jQuery("#"+e);return void 0===i.tables[e]?(void 0===n&&(n={dom:'<"listtable"ift>pl',paging:!1,lengthChange:!1,searching:!1,ordering:!0,info:!1,autoWidth:!0,columns:[],lengthMenu:[10,25,50,100,500,1e3],language:{emptyTable:r.data("langEmptyTable")?r.data("langEmptyTable"):"No records found"}}),jQuery.each(r.data(),function(e,t){void 0!==t&&("ajaxUrl"===e?n.ajax={url:t}:"lengthChange"===e?n.lengthChange=t:"pageLength"===e?n.pageLength=t:"langEmptyTable"===e?(void 0===n.language&&(n.language={}),n.language.emptyTable=t):"langZeroRecords"===e?(void 0===n.language&&(n.language={}),n.language.zeroRecords=t):n.key=t)}),jQuery.each(r.find("th"),function(){void 0===n.columns&&(n.columns=[]),n.columns.push({data:jQuery(this).data("name")})}),i.tables[e]=i.initTable(r,n)):void 0!==n&&(a=(t=i.tables[e]).init(),a=jQuery.extend(a,n),t.destroy(),i.tables[e]=i.initTable(r,a)),i.tables[e]},this.initTable=function(a,e){var e=a.DataTable(e),t=this;return a.data("on-draw")?e.on("draw.dt",function(e,t){var n=a.data("on-draw");"function"==typeof window[n]&&window[n](e,t)}):a.data("on-draw-rebind-confirmation")&&e.on("draw.dt",function(e){t.rebindConfirmation(e)}),e},this.rebindConfirmation=function(e){for(var t=this,n=e.target.id,a=WHMCS.ui.confirmation.register(),i=0,r=a.length;i<r;i++)jQuery(a[i]).on("confirmed.bs.confirmation",function(e){e.preventDefault(),WHMCS.http.jqClient.post(jQuery(e.target).data("target-url"),{token:csrfToken}).done(function(e){"success"!==e.status&&"okay"!==e.status||t.getTableById(n,void 0).ajax.reload()})})},this},clipboard:function(){return this.copy=function(e){e.preventDefault();var e=$(e.currentTarget),t=$(e).data("clipboard-target"),n=$(t).parent();try{var a=$("<textarea>").css("position","fixed").css("opacity","0").css("width","1px").css("height","1px").val($(t).val());n.append(a),a.focus().select(),document.execCommand("copy")}finally{a.remove()}e.tooltip({trigger:"click",placement:"bottom"}),WHMCS.ui.toolTip.setTip(e,"Copied!"),WHMCS.ui.toolTip.hideTip(e)},this},toolTip:function(){this.setTip=function(e,t){var n=e.data("bs.tooltip");return"in"!==n.hoverState&&(n.hoverState="in"),e.attr("data-original-title",t),n.show(),n},this.hideTip=function(e,t){return t=t||2e3,setTimeout(function(){e.data("bs.tooltip").hide()},t)}},jsonForm:function(){return this.managedElements="input,textarea,select",this.initFields=function(e){var t=this;$(e).find(t.managedElements).each(function(){var e=this;$(e).on("keypress change",function(){t.fieldHasError(e)&&t.clearFieldError(e)})})},this.init=function(t){var n=this;n.initFields(t),$(t).on("submit",function(e){e.preventDefault(),e.stopPropagation(),n.clearErrors(t);e=$(t).parents('.modal[role="dialog"]').first();$(e).length&&($(e).on("show.bs.modal hidden.bs.modal",function(){n.clearErrors(t)}),$(e).on("show.bs.modal",function(){$(t)[0].reset()})),WHMCS.http.client.post({url:$(t).attr("action"),data:$(t).serializeArray()}).done(function(e){n.onSuccess(t,e)}).fail(function(e){n.onError(t,e)}).always(function(e){n.onRequestComplete(t,e)})})},this.initAll=function(){var e=this;$('form[data-role="json-form"]').each(function(){e.init(this)})},this.markFieldErrors=function(e,t){var n,a,i=null;for(a in t)t.hasOwnProperty(a)&&(i=t[a]),n=this.managedElements.split(",").map(function(e){return e+'[name="'+a+'"]'}).join(","),n=$(e).find(n),i&&($(n).parents(".form-group").addClass("has-error"),$(n).attr("title",i),$(n).tooltip());$(e).find(".form-group.has-error input[title]").first().tooltip("show")},this.fieldHasError=function(e){return $(e).parents(".form-group").hasClass("has-error")},this.clearFieldError=function(t){try{$(t).tooltip("dispose")}catch(e){$(t).tooltip("destroy")}$(t).parents(".form-group").removeClass("has-error")},this.onSuccess=function(e,t){e=$(e).data("on-success");"function"==typeof e&&e(t.data)},this.onError=function(e,t){t.responseJSON&&t.responseJSON.fields&&"object"==typeof t.responseJSON.fields?this.markFieldErrors(e,t.responseJSON.fields):console.log("Unknown error - please try again later.");e=$(e).data("on-error");"function"==typeof e&&e(t)},this.clearErrors=function(e){var t=this;$(e).find(t.managedElements).each(function(){t.clearFieldError(this)})},this.onRequestComplete=function(e,t){},this},effects:function(){this.errorShake=function(e){var d={},d=$.extend({direction:"left",distance:8,times:3,speed:90},d);return e.each(function(){var e=$(this),t={position:e.css("position"),top:e.css("top"),bottom:e.css("bottom"),left:e.css("left"),right:e.css("right")},n=(e.css("position","relative"),"up"===d.direction||"down"===d.direction?"top":"left"),a="up"===d.direction||"left"===d.direction?"pos":"neg",i={},r={},o={};i[n]=("pos"==a?"-=":"+=")+d.distance,r[n]=("pos"==a?"+=":"-=")+2*d.distance,o[n]=("pos"==a?"-=":"+=")+2*d.distance,e.animate(i,d.speed);for(var s=1;s<d.times;s++)e.animate(r,d.speed).animate(o,d.speed);e.animate(r,d.speed).animate(i,d.speed/2,function(){e.css(t)})})}},markdownEditor:function(){this.editors={},this.counters={},this.register=function(){let n=this;jQuery(".container-markdown-editor").each(function(e,t){void 0===(t=jQuery(t)).attr("id")?console.debug("Element has no id",t):(n.getEditorById(t.attr("id")),n.withTagging(t))})},this.withTagging=function(e){e.is(".editor-tagging")&&e.atwho({at:"@",displayTpl:'<li class="mention-list">${gravatar} ${username} - ${name} (${email})</li>',insertTpl:mentionsFormat,data:e.data("tagging-url"),limit:5})},this.getEditorById=function(e){var t=jQuery("#"+e);return void 0===this.editors[e]&&(this.editors[e]=this.init(t)),this.editors[e]},this.init=function(e){let a=this,i=e.attr("id");var t=i+"-footer";let r="#"+t;var t='<div id="'+t+'" class="markdown-editor-status"></div>',n=void 0===e.data("locale")?"en":e.data("locale");let o=e.data("localStorageId"),s=csrfToken,d=e.data("fetchPreviewUrl");return a.counters[i]=0,e.markdown({footer:t,autofocus:!1,savable:!1,resize:"vertical",iconlibrary:"glyph",language:n,onShow:function(e){let t="",n=!1;"undefined"!=typeof Storage&&(t=localStorage.getItem(o),n=!0,t)&&void 0!==t&&e.setContent(t),jQuery(r).html(a.parseMdeFooter(t,n,"saved"))},onChange:function(e){let t=e.getContent(),n=!1;i=e.$element.attr("id"),"undefined"!=typeof Storage&&(a.counters[i]=3,n=!0,localStorage.setItem(o,t),a.doCountdown(i)),jQuery(r).html(a.parseMdeFooter(t,n))},onPreview:function(e){let t=e.getContent(),n;return jQuery.ajax({url:d,async:!1,data:{token:s,action:"parseMarkdown",content:t},dataType:"json",success:function(e){n=e},method:"POST"}),n.body||""},additionalButtons:[[{name:"groupCustom",data:[{name:"cmdHelp",title:"Help",hotkey:"Ctrl+F1",btnClass:"btn open-modal",icon:{glyph:"fas fa-question-circle",fa:"fas fa-question-circle","fa-3":"icon-question-sign"},callback:function(e){e.$editor.removeClass("md-fullscreen-mode")}}]}]],hiddenButtons:["cmdImage"]}),a.addEventHelpModal(e),e},this.parseMdeFooter=function(e,t,n){void 0===n&&(n="autosaving");let a=[],i=0,r=0;if(e&&(a=e.match(/[^\s]+/g),r=e.split(/\\r\\n|\\r|\\n/).length),a)for(let e=0;e<a.length;e++)19968<=a[e].charCodeAt(0)?i+=a[e].length:i+=1;return'<div class="smallfont">lines: '+r+"&nbsp;&nbsp;&nbsp;words: "+i+(t?'&nbsp;&nbsp;&nbsp;<span class="markdown-save">'+n+"</span>":"")+"</div>"},this.doCountdown=function(e){let t=this;0<=t.counters[e]&&(0===t.counters[e]&&jQuery("span.markdown-save").html("saved"),t.counters[e]--,setTimeout(function(e){t.doCountdown(e)},1e3,e))},this.addEventHelpModal=function(e){return e.parent().find('button[data-handler="bootstrap-markdown-cmdHelp"]').attr("data-modal-title","Markdown Guide").attr("data-modal-size","modal-lg").attr("href",e.data("fetchHelpUrl")),this}}}),WHMCS.hasModule("form")||WHMCS.loadModule("form",function(){return this.checkAllBound=false,this.register=function(){if(!this.checkAllBound){this.bindCheckAll();this.checkAllBound=true}},this.bindCheckAll=function(){var e=".btn-check-all";jQuery("body").on("click",e,function(e){var t=jQuery(e.target);var n=jQuery("#"+t.data("checkbox-container")+' input[type="checkbox"]');if(t.data("btn-check-toggle")){var a="Deselect All";var i="Select All";if(t.data("label-text-deselect"))a=t.data("label-text-deselect");if(t.data("label-text-select"))i=t.data("label-text-select");if(t.hasClass("toggle-active")){n.prop("checked",false);t.text(i);t.removeClass("toggle-active")}else{n.prop("checked",true);t.text(a);t.addClass("toggle-active")}}else if(t.data("btn-toggle-on"))n.prop("checked",true);else n.prop("checked",false)})},this.reloadCaptcha=e=>{if(typeof grecaptcha!=="undefined"){recaptchaValidationComplete=false;grecaptcha.reset();WHMCS.recaptcha.restoreDefaultCallback();return}if(!e)e=jQuery("#inputCaptchaImage");const t=jQuery("#inputCaptcha");if(e.length){e.attr("src",whmcsBaseUrl+"/includes/verifyimage.php?nocache="+(new Date).getTime());t.val("")}},this}),WHMCS.hasModule("selectize")||WHMCS.loadModule("selectize",function(){return $(document).ready(function(){const e=Selectize.prototype.setup;Selectize.prototype.setup=function(){e.apply(this,arguments);const n=this;this.$dropdown.off("mousedown","[data-selectable]");this.$dropdown.on("mouseup","[data-selectable]",function(){return n.onOptionSelect.apply(n,arguments)});this.$control.off("mousedown","*:not(input)");this.$control.on("mouseup","*:not(input)",function(e){let t=e.target;while(t&&t.parentNode!==n.$control[0])t=t.parentNode;e.currentTarget=t;return n.onItemSelect.apply(n,arguments)});this.$control_input.off("blur");$(document).off("mousedown"+this.eventNS);$(document).on("mousedown"+this.eventNS,function(e){if(n.isFocused){if(e.target===n.$dropdown[0]||e.target.parentNode===n.$dropdown[0])return false;if(!n.$dropdown.has(e.target).length&&e.target!==n.$control[0])n.blur(e.target)}})}}),this.clientSearch=function(){var a=function(e,t){if(typeof dropdownSelectClient==="function")if(jQuery(".selectize-dropdown-content > div").length===0)dropdownSelectClient(t(e.id),t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):""),t(e.email));return'<div class="client-name"><span class="name">'+t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):"")+"</span></div>"};var e=".selectize-client-search";var t=jQuery(e);var i=this;var r=[];t.each(function(){var t=$(this);var e={valueField:t.data("value-field"),allowEmptyOption:t.data("allow-empty-option")===1,labelField:"name",render:{item:a},optgroupField:"status",optgroupLabelField:"name",optgroupValueField:"id",optgroups:[{$order:1,id:"active",name:t.data("active-label")},{$order:2,id:"inactive",name:t.data("inactive-label")}],load:i.builder.onLoadEvent(t.data("search-url"),function(e){return{dropdownsearchq:e,clientId:n.currentValue,showNoneOption:t.data("allow-empty-option")===1}}),onChange:function(e){if(e&&typeof dropdownSelectClient==="function"){e=parseInt(e);var t=jQuery(".selectize-dropdown-content div[data-value|='"+e+"']");dropdownSelectClient(e,t.children("span.name").text(),t.children("span.email").text())}}};var n=i.clients(t,undefined,e);n.on("change",i.builder.onChangeEvent(n,"#goButton"));return r.push(n)});if(r.length>1)return r;return r[0]},this.userSearch=function(){var a=function(e,t){var n="",a=!isNaN(e.id);if(a&&e.id>0)n=" - #"+t(e.id);return'<div><span class="name">'+t(e.name)+n+"</span></div>"};var i=".selectize-user-search";var e=jQuery(i);var r=this;var o=[];e.each(function(){var e=$(this);var t={valueField:e.data("value-field"),labelField:"name",render:{item:a},preload:false,load:r.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}})};var n=r.users(i,undefined,t);return o.push(n)});if(o.length>1)return o;return o[0]},this.serviceSearch=function(){var a=function(e){var t=$("<div>");if(e.color)t.css("background-color",e.color);t.append($("<span>").attr("class","name").text(e.name));return t};var i=".selectize-service-search";var e=jQuery(i);var r=this;var o=[];e.each(function(){var e=$(this);var t={valueField:"id",labelField:"name",render:{item:a},preload:true,load:r.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}})};var n=r.services(i,undefined,t);return o.push(n)});if(o.length>1)return o;return o[0]},this.productSearch=function(){var n=".selectize-product-search",e=jQuery(n),a=this,i=[],r=function(e,t){var n=jQuery("<div>"),a=jQuery("<span>").attr("class","name").text(t(e.name));n.append(a);return n};e.each(function(){var e=jQuery(this),t={valueField:"id",labelField:"name",render:{item:r},optgroupField:"groupid",optgroupLabelField:"name",optgroupValueField:"id",preload:true,load:a.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}}),onLoad:function(e){var t=this,n=jQuery(".product-recommendations-wrapper li");e.forEach(function(e){if(n.find('input[value="'+e.id+'"]').length){t.removeOption(e.id);return}t.addOptionGroup(e.groupid,{$order:e.order,name:e.group})})},onBlur:function(){this.clear()},onItemAdd:function(e){var t=jQuery(".product-recommendations-wrapper li"),n=t.find('input[value="'+e+'"]').length,a=jQuery("div.recommendation-alert"),i=false;if(e&&n<1){var r=jQuery(".selectize-dropdown-content div[data-value|='"+e+"']"),o=jQuery(".product-recommendations-wrapper .clonable-item"),s=o.closest("ul"),d=o.clone().removeClass("hidden clonable-item");d.find("a span.recommendation-name").text(r.siblings("div.optgroup-header").text()+" - "+r.children("span.name").text());jQuery("<input>").attr({type:"hidden",name:"productRecommendations[]",value:e}).appendTo(d);d.find("input").val(e);d.appendTo(s);l.removeOption(e);i=true}if(t.length>0){jQuery(".product-recommendations-wrapper .placeholder-list-item").addClass("hidden");i=true}if(i&&a.not(":visible"))jQuery(".recommendation-alert").removeClass("hidden")}},l=a.products(n,undefined,t);return i.push(l)});if(i.length>1)return i;return i[0]},this.clients=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.client,n);a.settings.searchField=["name","email","companyname"];return a},this.users=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.user,n);a.settings.searchField=["name","email"];return a},this.services=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.service,n);a.settings.searchField=["name","noResults"];return a},this.billingContacts=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.billingContact,n);a.settings.searchField=["name","email","companyname","address"];return a},this.payMethods=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.payMethod,n);a.settings.searchField=["description","shortAccountNumber","type","payMethodType"];return a},this.products=function(e,t,n){var a=this.register(e,t,WHMCS.selectize.optionDecorator.product,n);a.settings.searchField=["id","name","noResults"];return a},this.html=function(e,t,n){var a=this.register(e,t,function(e,t){return'<div class="item">'+e.html+"</div>"},n);a.settings.searchField=["html"];return a},this.simple=function(e,t,n){var a=this.register(e,t,function(e,t){return'<div class="item">'+e.value+"</div>"},n);a.settings.searchField=["value"];return a},this.register=function(e,t,n,a){var i=this;var r=jQuery(e);var o=i.builder.init(r,a);var s=i.builder.itemDecorator(n);if(typeof a==="undefined"){o.settings.render.item=s;o.settings.render.option=s}else if(typeof a.render==="undefined"){o.settings.render.item=s;o.settings.render.option=s}else{if(typeof a.render.item==="undefined")o.settings.render.item=s;if(typeof a.render.option==="undefined")o.settings.render.option=s}this.builder.addOptions(o,t);return o},this.optionDecorator={client:function(e,t){var n=t(e.name),a="",i="",r="";if(e.companyname)a=" ("+t(e.companyname)+")";if(typeof e.descriptor==="undefined")i=e.id>0?" - #"+t(e.id):"";else i=t(e.descriptor);if(e.email)r='<span class="email">'+t(e.email)+"</span>";return"<div>"+'<span class="name">'+n+a+i+"</span>"+r+"</div>"},user:function(e,t){var n=t(e.name),a="",i="",r=!isNaN(e.id);if(typeof e.descriptor==="undefined")a=r&&e.id>0?" - #"+t(e.id):"";else a=t(e.descriptor);if(r&&e.id>0&&e.email)i='<span class="email">'+t(e.email)+"</span>";return"<div>"+'<span class="name">'+n+a+"</span>"+i+"</div>"},billingContact:function(e,t){var n=t(e.name),a="",i="",r="",o="";if(e.companyname)a=" ("+t(e.companyname)+")";if(typeof e.descriptor==="undefined")i=e.id>0?" - #"+t(e.id):"";else i=t(e.descriptor);if(e.email)r='<span class="email">'+t(e.email)+"</span>";if(e.address)o='<span class="email">'+t(e.address)+"</span>";return"<div>"+'<span class="name">'+n+a+i+"</span>"+r+o+"</div>"},payMethod:function(e,t){var n="",a="",i="",r="",o="";if(e.brandIcon)n='<i class="'+e.brandIcon+'"></i>';if(e.isDefault)i='&nbsp;&nbsp;<i class="fal fa-user-check"></i>';if(e.description)a=e.description;if(e.shortAccountNumber)if(a.indexOf(e.shortAccountNumber)===-1)r="("+t(e.shortAccountNumber)+")";if(e.detail1)o='<span class="mouse">'+t(e.detail1)+"</span>";return"<div>"+'<span class="name"> '+n+"&nbsp;"+a+"&nbsp;"+r+"&nbsp;"+"&nbsp;&nbsp;"+o+"&nbsp;&nbsp;"+i+"</span>"+"</div>"},service:function(e,t){var n="";if(e.color)n=' style="background-color: '+e.color+';"';return"<div"+n+'><span class="name">'+t(e.name)+"</span>"+(e.noResults?'<span class="email">'+t(e.noResults)+"</span>":"")+"</div>"},product:function(e,t){return'<div><span class="name">'+t(e.name)+"</span>"+(e.noResults?'<span class="email">'+t(e.noResults)+"</span>":"")+"</div>"}},this.builder={init:function(a,e){var t,n={plugins:["whmcs_no_results"],valueField:"id",labelField:"id",create:false,maxItems:1,preload:"focus"};if(typeof e==="undefined")e={};t=jQuery.extend({},n,e);var i=a.selectize(t);i=i[0].selectize;i.currentValue="";i.on("focus",function(){i.currentValue=i.getValue();i.clear()});i.on("blur",function(){var e=i.getValue(),t=!isNaN(e),n=1;if(a.data("allow-empty-option")===1)n=0;if(e===""||t&&e<n)i.setValue(i.currentValue)});return i},addOptions:function(e,t){if(typeof t!=="undefined"&&t.length)e.addOption(t)},itemDecorator:function(e){if(typeof e==="function")return e;else if(typeof e==="undefined")return WHMCS.selectize.optionDecorator.user},onLoadEvent:function(n,a){return function(e,t){jQuery.ajax({url:n,type:"POST",dataType:"json",data:a(e),error:function(){t()},success:function(e){t(e)}})}},onChangeEvent:function(n,a){var e;if(typeof a!=="undefined")e=function(e){var t=jQuery(a);if(t.length)if(!isNaN(n.currentValue)&&n.currentValue>0&&(e.length&&e!==n.currentValue))t.click()};return e}},this}),function(e){WHMCS.hasModule("payment")||WHMCS.loadModule("payment",e)}({internal:function(){this.isRenderSource=function(e){return["checkout","invoice-pay","admin-payment-method-add","admin-payment-method-edit","payment-method-add","payment-method-edit"].includes(e)},this.reportUnknownSource=function(e){return!WHMCS.payment.internal.isRenderSource(e)&&(WHMCS.payment.internal.logError("unknown source: "+e),!0)},this.logError=function(e){console.error("[WHMCS.payment] "+e)}},handler:function(){this.make=function(e){return new function(e){this.module=e,this.onGatewayInit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayInit(this.module,e,t),this},this.onGatewayOptionInit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayOptionInit(this.module,e,t),this},this.onGatewaySelected=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewaySelected(this.module,e,t),this},this.onGatewayUnselected=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayUnselected(this.module,e,t),this},this.onCheckoutFormSubmit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onCheckoutFormSubmit(this.module,e,t),this},this.onAddPayMethodFormSubmit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onAddPayMethodFormSubmit(this.module,e,t),this},this.manageInputsContainer=function(n,e={}){e={...WHMCS.payment.register.defaultEventOpts(),priority:1,...e};return this.onGatewayInit(function(e,t){"invoice-pay"==e._source&&(WHMCS.payment.display.reset(),WHMCS.payment.display.show(jQuery(n)))},e),this.onGatewaySelected(function(e,t){"payment-method-add"==e._source&&(WHMCS.payment.display.reset(),jQuery("div.fieldgroup-creditcard,div.fieldgroup-bankaccount,div.fieldgroup-auxfields").hide()),WHMCS.payment.display.show(jQuery(n))},e),this.onGatewayUnselected(function(e,t){WHMCS.payment.display.hide(jQuery(n))},e),this}}(e)}},register:function(){this.onGatewayInit=function(e,t,n){return this.isFunction("register.gatewayInit",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayInit,e,t,n),this},this.onGatewayOptionInit=function(e,t,n){return this.isFunction("register.gatewayOptionInit",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayOptionInit,e,t,n),this},this.onGatewaySelected=function(e,t,n){return this.isFunction("register.onGatewaySelected",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewaySelected,e,t,n),this},this.onGatewayUnselected=function(e,t,n){return this.isFunction("register.onGatewayUnselected",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayUnselected,e,t,n),this},this.onCheckoutFormSubmit=function(e,t,n){return this.isFunction("register.onCheckoutFormSubmit",t)&&this.registerForEvent(WHMCS.payment.event.observersCheckoutFormSubmit,e,t,n),this},this.onAddPayMethodFormSubmit=function(e,t,n){return this.isFunction("register.onAddPayMethodFormSubmit",t)&&this.registerForEvent(WHMCS.payment.event.observersAddPayMethodFormSubmit,e,t,n),this},this.defaultEventOpts=function(){return{priority:100,once:!1}},this.registerForEvent=function(e,t,n,a){return e.has(t)||e.set(t,new Map),e.get(t).set(a.priority,{_fn:n,...a}),this},this.isFunction=function(e,t){return"function"==typeof t||(console.error("[register."+e+"] Expecting a function, got "+t),!1)}},event:function(){this.observersGatewayInit=new Map,this.observersGatewayOptionInit=new Map,this.observersGatewaySelected=new Map,this.observersGatewayUnselected=new Map,this.observersCheckoutFormSubmit=new Map,this.observersAddPayMethodFormSubmit=new Map,this.previouslySelected=null,this.gatewayInit=function(e,t){this.notifyEvent("gatewayInit",this.observersGatewayInit,t,e)},this.gatewayOptionInit=function(e,t,n){this.notifyEvent("gatewayOptionInit",this.observersGatewayOptionInit,t,e,n)},this.gatewaySelected=function(e,t,n){this.previouslySelected={formElement:n,module:t},this.notifyEvent("gatewaySelected",this.observersGatewaySelected,t,e,n)},this.gatewayUnselected=function(e){null!=this.previouslySelected&&this.notifyEvent("gatewayUnselected",this.observersGatewayUnselected,this.previouslySelected.module,e,this.previouslySelected.formElement)},this.checkoutFormSubmit=function(e,t,n){this.notifyEvent("checkoutFormSubmit",this.observersCheckoutFormSubmit,t,e,n)},this.addPayMethodFormSubmit=function(e,t,n){this.notifyEvent("addPayMethodFormSubmit",this.observersAddPayMethodFormSubmit,t,e,n)},this.notifyEvent=function(e,t,n,a,i){var r,o;t.has(n)&&(r=t.get(n),o=[],this.notifyOrdered(r,function(e,t){e._fn(a,i),e.once&&o.push(t)}),o.forEach(function(e){r.delete(e)}))},this.notifyOrdered=function(e,t){new Map([...e.entries()].sort()).forEach(t)}},query:function(){this.isGatewaySelected=function(e){return null!=WHMCS.payment.event.previouslySelected&&WHMCS.payment.event.previouslySelected.module==e}},behavior:function(){this.disableDefaultCardValidation=function(e){"invoice-pay"==e?"function"==typeof validateCreditCardInput&&jQuery("#frmPayment").off("submit",validateCreditCardInput):"checkout"==e?"function"==typeof validateCheckoutCreditCardInput&&jQuery("#frmCheckout").off("submit",validateCheckoutCreditCardInput):WHMCS.payment.internal.reportUnknownSource(e)},this.enableDefaultCardValidation=function(e){"invoice-pay"==e?"function"==typeof validateCreditCardInput&&jQuery("#frmPayment").on("submit",validateCreditCardInput):"checkout"==e?"function"==typeof validateCheckoutCreditCardInput&&jQuery("#frmCheckout").on("submit",validateCheckoutCreditCardInput):WHMCS.payment.internal.reportUnknownSource(e)}},display:function(){this.reset=function(){var e=jQuery("#paymentGatewayInput");if(0!=e.length)return(e=e.children()).hide(),jQuery("body").append(e),this},this.show=function(e){var t=jQuery("#paymentGatewayInput");if(0!=t.length)return t.append(e),e.slideDown(),this},this.hide=function(e){return e.slideUp({complete:function(){jQuery("body").append(e)}}),this},this.error=function(e){return jQuery(".gateway-errors").html(e),this},this.errorClear=function(){var e=jQuery(".gateway-errors");if(0!=e.length)return this.error(""),e.slideUp(),this},this.errorShow=(e,t="invoice-pay")=>{var n=jQuery(".gateway-errors");if("checkout"===t&&"function"==typeof showCheckoutError&&showCheckoutError(e,n),"invoice-pay"===t){if(0===n.length)return this;this.error(e),n.slideDown()}return this},this.submitReset=function(e){"invoice-pay"==e?this.invoiceSubmitReset():"checkout"==e?this.checkoutSubmitReset():WHMCS.payment.internal.reportUnknownSource(e)},this.invoiceSubmitReset=function(){var e=jQuery("#btnSubmit").prop("disabled",!1).removeClass("disabled");e.find(".click-text").hide(),e.find(".pay-text").show()},this.checkoutSubmitReset=function(){jQuery("#btnCompleteOrder").removeClass("disabled").removeClass("disable-on-click").removeClass("spinner-on-click").addClass("disable-on-click spinner-on-click").prop("disabled",!1).find("i.fas").removeAttr("class").addClass("fas fa-arrow-circle-right")},this.submitDisable=function(e){"invoice-pay"==e?this.invoiceSubmitDisable():"checkout"==e?this.checkoutSubmitDisable():WHMCS.payment.internal.reportUnknownSource(e)},this.invoiceSubmitDisable=function(){jQuery("#btnSubmit").addClass("disabled").prop("disabled",!0)},this.checkoutSubmitDisable=function(){jQuery("#btnCompleteOrder").addClass("disabled").prop("disabled",!0)}}}),jQuery(document).ready(function(){function t(){addingPayment=!1,jQuery("#btnAddPayment").attr("disabled","disabled"),jQuery("#paymentText").hide(),jQuery("#paymentLoading").removeClass("hidden").show();var e=Object.fromEntries(new FormData(document.forms.namedItem("addPayment")));WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/billing/check-transaction"),{token:e.token,transaction_id:e.transid,payment_method:e.paymentmethod}).done(function(e){!1===e.unique?jQuery("#modalDuplicateTransaction").modal("show"):addInvoicePayment()})}jQuery('[data-toggle="tooltip"]').tooltip(),jQuery('[data-toggle="popover"]').popover(),jQuery(".inline-editable").editable({mode:"inline",params:function(e){return e.action="savefield",e.token=csrfToken,e}}),generateBootstrapSwitches(),jQuery("select.form-control.enhanced").select2({theme:"bootstrap"}),jQuery("body").on("click",".copy-to-clipboard",WHMCS.ui.clipboard.copy),jQuery(".credit-card-type li a").click(function(){jQuery("#selectedCard").html(jQuery(this).html()),jQuery("#cctype").val(jQuery("span.type",this).html())}),jQuery(".paging-dropdown li a,.page-selector").click(function(){var e;return jQuery(this).parent().hasClass("disabled")||(e=jQuery("#frmRecordsFound"),jQuery("#currentPage").html(jQuery(this).data("page")),e.find('input[name="page"]').val(jQuery(this).data("page")).end(),e.submit()),!1}),jQuery(".no-results a").click(function(e){e.preventDefault(),jQuery("#checkboxShowHidden").bootstrapSwitch("state",!1)}),jQuery("body").on("click","a.autoLinked",function(e){if(e.preventDefault(),jQuery(this).hasClass("disabled"))return!1;e=window.open();e.opener=null,e.location=$(this).attr("href")}),jQuery("#divModuleSettings").on("click",".icon-refresh",function(){fetchModuleSettings(jQuery(this).data("product-id"),"simple"),processAddonDisplay()}),jQuery("#mode-switch").click(function(){fetchModuleSettings(jQuery(this).data("product-id"),jQuery(this).attr("data-mode"))}),$("body").on("click",".modal-wizard .modal-submit",function(){var o=$("#modalAjax"),e=(o.find(".loader").show(),o.find(".modal-submit").prop("disabled",!0),$(".modal-wizard .wizard-step:hidden :input").attr("disabled",!0),document.forms.namedItem("frmWizardContent")),e=new FormData(e),t=$(".modal-wizard .wizard-step:visible").data("step-number"),n=$("#ccGatewayFormSubmitted").val(),a=$("#enomFormSubmitted").val(),s=new XMLHttpRequest;n&&3==t||a&&5==t?(wizardStepTransition(!1,!0),fadeoutLoaderAndAllowSubmission(o)):(s.open("POST",$("#frmWizardContent").attr("action"),!0),s.send(e),s.onload=function(){if(200==s.status)try{var e,t=JSON.parse(s.responseText),n=$("#btnWizardDoNotShow");if(n.is(":visible")&&n.fadeOut("slow",function(){$("#btnWizardSkip").hide().removeClass("hidden").fadeIn("slow")}),t.success){if(t.sslData){var a=t.sslData;if(a.approverEmails)for(i=0;i<a.approverEmails.length;i++){var r=a.approverEmails[i];$(".modal-wizard .cert-approver-emails").append('<label class="radio-inline"><input type="radio" name="approver_email" value="'+r+'"> '+r+"</label><br>")}if(a.approvalMethods)for(i=0;i<a.approvalMethods.length;i++)$("label[for='"+a.approvalMethods[i]+"Method']").removeClass("hidden").show()}else t.authData&&("emailauth"==(e=t.authData).method?($(".modal-wizard .cert-email-auth").removeClass("hidden"),$(".modal-wizard .cert-email-auth-emailapprover").val(e.email)):"fileauth"==e.method?($(".modal-wizard .cert-file-auth").removeClass("hidden"),$(".modal-wizard .cert-file-auth-filename").val("http://<domain>/"+e.path+"/"+e.name),$(".modal-wizard .cert-file-auth-contents").val(e.contents)):"dnsauth"==e.method&&($(".modal-wizard .cert-dns-auth").removeClass("hidden"),$(".modal-wizard .cert-dns-auth-contents").val(e.value),$(".modal-wizard .cert-dns-auth-host").val(e.host),$(".modal-wizard .cert-dns-auth-type").val(e.type)));t.refreshMc&&$("#btnMcServiceRefresh").click(),wizardStepTransition(t.skipNextStep,!1)}else wizardError(t.error)}catch(e){wizardError("An error occurred while communicating with the server. Please try again.")}finally{fadeoutLoaderAndAllowSubmission(o)}else alert("An error occurred while communicating with the server. Please try again."),o.find(".loader").fadeOut()})}).on("click","#btnWizardSkip",function(e){e.preventDefault();var e=$("#inputWizardStep").val(),t="2"!==e&&"4"!==e?!1:!0;trackWizardAction(e,"skipped"),wizardStepTransition(t,!0)}).on("click","#btnWizardBack",function(e){e.preventDefault(),wizardStepBackTransition()}).on("click","#btnWizardDoNotShow",function(e){e.preventDefault(),WHMCS.http.jqClient.post("wizard.php","dismiss=true",function(){$("#modalAjax").modal("hide")})}),$("#modalAjax").on("hidden.bs.modal",function(e){$("#modalAjax").hasClass("modal-wizard")&&($("#btnWizardSkip").remove(),$("#btnWizardBack").remove(),$("#btnWizardDoNotShow").remove())}),$("#prodsall").click(function(){var e=$(".checkprods");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#addonsall").click(function(){var e=$(".checkaddons");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#domainsall").click(function(){var e=$(".checkdomains");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),jQuery("#addPayment").submit(function(e){e.preventDefault(),"edit"===getQueryParam("action")?handleUnsavedChanges(e,function(){t()}):t()}),$("#modalDuplicateTransaction").on("hidden.bs.modal",function(){!1===addingPayment&&jQuery("#paymentLoading").hide("fast",function(){jQuery("#paymentText").show("fast"),jQuery("#btnAddPayment").removeAttr("disabled")})}),jQuery(document).on("click",".feature-highlights-content .btn-action-1, .feature-highlights-content .btn-action-2",function(){var e=jQuery(this).data("link"),t=jQuery(this).data("link-title");WHMCS.http.jqClient.post("whatsnew.php",{action:"link-click",linkId:e,linkTitle:t,token:csrfToken})}),"undefined"!=typeof mentionsFormat&&jQuery('#replynote[name="message"],#note[name="note"]').atwho({at:"@",displayTpl:'<li class="mention-list">${gravatar} ${username} - ${name} (${email})</li>',insertTpl:mentionsFormat,data:WHMCS.adminUtils.getAdminRouteUrl("/mentions"),limit:5}),jQuery(".search-bar .search-icon").click(function(e){jQuery(".search-bar").find("input:first").focus()}),jQuery(".btn-search-advanced").click(function(e){jQuery(this).closest(".search-bar").find(".advanced-search-options").slideToggle("fast")}),WHMCS.ui.dataTable.register(),WHMCS.ui.confirmation.register(),WHMCS.ui.markdownEditor.register();var e,n=jQuery("#mcConfigureProductPromos");n.length&&(e=n.find(".item").length,n.owlCarousel({loop:!0,margin:10,responsiveClass:!0,responsive:{0:{items:1},850:{items:e<2?e:2},1250:{items:e<3?e:3},1650:{items:e<4?e:4}}}),jQuery("#dismissPromos").on("click",function(){n.slideUp("fast"),jQuery(this).hide(),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/dismiss-marketconnect-promo"),{token:csrfToken},function(e){})})),jQuery(document).on("submit","#frmCreditCardDeleteDetails",function(e){e.preventDefault(),jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax .loader").show(),$("#remoteFailureDetails").slideUp(),WHMCS.http.jqClient.post(jQuery(this).attr("action"),jQuery(this).serialize(),function(e){e.error?($("#remoteFailureDetails").find(".alert").html(e.errorMsg).end().slideDown(),jQuery("#modalAjax .loader").fadeOut()):updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}),jQuery(".captcha-type").length&&jQuery(document).on("change",".captcha-type",function(){jQuery("#captcha-preview").attr("src",jQuery(this).find(":selected").data("image"));var e=jQuery(".recaptchasetts"),t=jQuery(".recaptchav3setts"),n=jQuery(".hcaptchasetts"),a=jQuery(this).val();["recaptcha","invisible"].includes(a)?(e.show(),t.hide(),n.hide()):["hcaptcha","hcaptcha-invisible"].includes(a)?(e.hide(),t.hide(),n.show()):"recaptchav3"===a?(n.hide(),e.show(),t.show()):(e.hide(),n.hide(),t.hide())}),jQuery("#frmClientSearch").length&&jQuery(document).on("change",".status",function(){jQuery("#status").val(jQuery(this).val())}),jQuery(".ssl-state.ssl-sync").each(function(){var t=jQuery(this);WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/domains/ssl-check"),{domain:t.data("domain"),userid:t.data("user-id"),token:csrfToken},function(e){t.replaceWith('<img src="'+e.image+'" data-toggle="tooltip" title="'+e.tooltip+'" class="'+e.class+'">'),jQuery('[data-toggle="tooltip"]').tooltip()})}),jQuery.fn.setInputError=function(e){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").text(e),this},jQuery.fn.showInputError=function(){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").show(),this},jQuery(".datatable .view-detail").click(function(e){e.preventDefault(),$currentRow=jQuery(this).closest("tr");var t;jQuery(this).hasClass("expanded")?($currentRow.next("tr.detail-row").hide(),jQuery(this).removeClass("expanded").find("i").removeClass("fa-minus").addClass("fa-plus")):(t=$currentRow.find("td").length,jQuery(this).hasClass("data-loaded")?$currentRow.next("tr.detail-row").show():($currentRow.after('<tr class="detail-row"><td colspan="'+t+'"><i class="fa fa-spinner fa-spin"></i> Loading...</td></tr>'),WHMCS.http.jqClient.jsonGet({url:jQuery(this).attr("href"),success:function(e){$currentRow.next("tr.detail-row").remove(),$currentRow.after('<tr class="detail-row"><td colspan="'+t+'">'+e.output+"</td></tr>")}})),jQuery(this).find("i").addClass("fa-minus").removeClass("fa-plus"),jQuery(this).addClass("expanded").addClass("data-loaded"))}),jQuery(document).on("change",".toggle-display",function(){var e=jQuery(this).data("show"),e=jQuery("."+e);jQuery(document).find("div.toggleable").hide(),e.hasClass("hidden")&&e.removeClass("hidden"),e.show()}),jQuery(document).on("click","button.disable-submit",function(e){var t=jQuery(this),n=t.closest("form");t.prepend('<i class="fas fa-spinner fa-spin"></i> ').addClass("disabled").prop("disabled",!0),n.submit()}),jQuery("#btnResendVerificationEmail").click(function(){var t=$(this);t.prop("disabled",!0).html('<i class="fa fa-spinner fa-spin fa-fw"></i> '+t.html()),WHMCS.http.jqClient.jsonPost({url:window.location.href,data:{token:csrfToken,action:"resendVerificationEmail",userid:t.data("clientid")},success:function(e){e.success?t.html(t.data("successmsg")):t.html(t.data("errormsg"))}})}),"undefined"!=typeof Selectize&&Selectize.define("whmcs_no_results",function(e){var i;this.search=(i=this.search,function(){function t(e){return isNaN(e.id)||0<e.id}var e=i.apply(this,arguments),n=e.items.filter(t),a=e.items.filter(function(e){return!t(e)});return 0<n.length?e.items=n:0<a.length&&(e.items=[a[0]]),e})}),jQuery('.addon-type[name="atype"]').on("change",function(){fetchModuleSettings(jQuery(this).closest("td").data("addon-id")),processAddonDisplay()}),jQuery(document).on("change",".module-action-control",function(){var e=$(this).data("actor"),e=jQuery('.module-action-param-row[data-action-type="'+e+'"]');parseInt($(this).val())?e.show():e.hide()}),jQuery(document).on("click",".btn-create-module-action-custom-field",function(){var t=this,e=jQuery(t).data("product-id");jQuery(t).attr("disabled","disabled"),WHMCS.http.jqClient.jsonPost({url:"configproducts.php",data:{action:"create-module-action-custom-field",id:e,token:csrfToken,field_name:jQuery(t).data("field-name"),field_type:jQuery(t).data("field-type")},success:function(e){var t=jQuery("#btnSaveProduct");jQuery(t).attr("disabled")?jQuery.growl.notice({title:"",message:e.successMsg}):jQuery(t).trigger("click")},error:function(e){jQuery(t).removeAttr("disabled"),jQuery.growl.warning({title:"",message:e})}})}),jQuery.each(jQuery("table.table-themed.data-driven"),function(){var i=$(this),e=i.DataTable();e.on("preXhr.dt",function(e,t,n){var a=document.createElement("div");jQuery(a).css({"background-color":"#fff",opacity:"0.5",position:"absolute",top:i.offset().top,left:i.offset().left,width:i.width()+2,height:i.height()+2,"line-height":i.height()+"px","font-size":"40px","text-align":"center",color:"#000","border-radius":i.css("border-radius"),zIndex:100}).attr("id",i.attr("id")+"overlay").html('<strong><i class="fas fa-spinner fa-pulse"></i></strong>'),i.before(a),n.token=csrfToken}),e.on("xhr.dt",function(e,t,n,a){jQuery("#"+i.attr("id")+"overlay").remove(),i.removeClass("text-muted")})})});var addingPayment=!1,loadedModuleConfiguration=!1,addonSupportsFeatures=!1;function updateServerGroups(e){var t="";$("#inputServerGroup").find("option:not([value=0])").each(function(){t=$(this).attr("data-server-types"),!e||!t||-1<t.indexOf(","+e+",")?$(this).attr("disabled",!1):($(this).attr("disabled",!0),$(this).is(":selected")&&$("#inputServerGroup").val("0"))})}function processAddonDisplay(){var e,t,n=jQuery('input[name="atype"]:checked');loadedModuleConfiguration?(e=jQuery("#associatedPackages"),t=jQuery("#rowProductType,#rowServerGroup"),e.find("option").prop("disabled",!1),addonSupportsFeatures&&jQuery("#addonProvisioningType").find("div.radio").each(function(){$(this).removeClass("radio-disabled").find("input").prop("disabled",!1)}),"feature"===n.val()?(e.find('option[data-server-module!="'+$("#inputModule").val()+'"]').prop("checked",!1).prop("disabled",!0),t.find("select").addClass("disabled").prop("disabled",!0)):(e.find("option").prop("disabled",!1),t.find("select").removeClass("disabled").prop("disabled",!1).find('option[value="notAvailable"]').remove()),e.bootstrapDualListbox("refresh",!0)):setTimeout(processAddonDisplay,100)}function fetchModuleSettings(e,t){var i=!1,r=$("#mode-switch"),o=$("#inputModule").val(),s=jQuery("#addonProvisioningType");if(""!==o)return loadedModuleConfiguration=!1,requestedMode=t="simple"!==(t=t||"simple")&&"advanced"!==t?"simple":t,$("#divModuleSettings").addClass("module-settings-loading"),$("#tblModuleAutomationSettings").addClass("module-settings-loading"),$("#tblMetricSettings").addClass("module-settings-loading"),$("#serverReturnedError").addClass("hidden"),$("#moduleSettingsLoader").removeClass("hidden").show(),r.attr("data-product-id",e),WHMCS.http.jqClient.post(window.location.pathname,{action:"module-settings",module:o,servergroup:$("#inputServerGroup").val(),id:e,type:$("#selectType").val(),atype:$('input[name="atype"]:checked').val(),mode:t},function(e){var t,n,a;i=!0,$("#divModuleSettings").removeClass("module-settings-loading"),$("#tblModuleAutomationSettings").removeClass("module-settings-loading"),$("#tblMetricSettings").removeClass("module-settings-loading"),$("#divModuleSettings").html(""),r.parent("div .module-settings-mode").addClass("hidden"),o&&e.error&&($("#serverReturnedErrorText").html(e.error),$("#serverReturnedError").removeClass("hidden")),o&&e.content?($("#noModuleSelectedRow").addClass("hidden"),$("#divModuleSettings").html(e.content),$("#tblModuleAutomationSettings").find("input[type=radio]").removeAttr("disabled"),"simple"===e.mode?(r.attr("data-mode","advanced").find("span").addClass("hidden").parent().find(".text-advanced").removeClass("hidden"),r.parent("div .module-settings-mode").removeClass("hidden")):"advanced"===e.mode&&"advanced"===requestedMode?(r.attr("data-mode","simple").find("span").addClass("hidden").parent().find(".text-simple").removeClass("hidden"),r.parent("div .module-settings-mode").removeClass("hidden")):r.parent("div .module-settings-mode").addClass("hidden"),e.metrics?($("#metricsConfig").html(e.metrics).show(),$("#tblMetricSettings").removeClass("hidden").show(),$(".metric-toggle").bootstrapSwitch({size:"mini",onColor:"success"}).on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"action=toggle-metric&id="+$("#inputProductId").val()+"&module="+o+"&metric="+$(this).data("metric")+"&token="+csrfToken+"&enable="+t)})):$("#tblMetricSettings").hide(),s.length&&(t=jQuery("#associatedPackages"),a=(n=jQuery("#selectType,#inputServerGroup")).find('option[value="notAvailable"]'),void 0!==e.supportsFeatures&&(addonSupportsFeatures=e.supportsFeatures,s.find("div.radio").each(function(){$(this).removeClass("radio-disabled").find("input").prop("disabled",!1)})),addonSupportsFeatures?(t.find("option").prop("disabled",!0),"feature"===jQuery('input[name="atype"]:checked').val()&&(n.addClass("disabled").prop("disabled",!0),a.length||n.prepend($("<option>").val("notAvailable").text(e.languageStrings.notAvailableForStyle).attr("selected","selected")))):(jQuery('input[name="atype"]').first().prop("checked",!0),s.find("div.radio").each(function(){$(this).addClass("radio-disabled").find("input").prop("disabled",!0)}),t.find("option").prop("disabled",!1),n.removeClass("disabled").prop("disabled",!1),a.remove()),t.bootstrapDualListbox("refresh",!0))):($("#noModuleSelectedRow").removeClass("hidden"),$("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0))},"json").always(function(){$("#moduleSettingsLoader").fadeOut(),jQuery('[data-toggle="tooltip"]').tooltip(),updateServerGroups(i?o:""),loadedModuleConfiguration=!0}),"";$("#divModuleSettings").html(""),$("#noModuleSelectedRow").removeClass("hidden"),$("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0),s.length&&(jQuery('input[name="atype"]').first().prop("checked",!0),s.find("div.radio").each(function(e){$(this).addClass("radio-disabled").find("input").prop("disabled",!0)}))}function wizardCall(e,t,n){e="wizard="+$('input[name="wizard"]').val()+"&step="+$('input[name="step"]').val()+"&token="+$('input[name="token"]').val()+"&action="+e+"&"+t;WHMCS.http.jqClient.post("wizard.php",e,n)}function wizardError(e){WHMCS.ui.effects.errorShake($(".modal-wizard .wizard-step:visible .info-alert:first").html(e).removeClass("hidden").addClass("alert-danger"))}function wizardStepTransition(e,t){var n=$(".modal-wizard .wizard-step:visible").data("step-number"),a=(increment=e?2:1,$(".modal-wizard .wizard-step:visible")),i=n+increment;$("#wizardStep"+i).length?(trackWizardPageView(i),$("#wizardStep"+n).fadeOut("",function(){var e="completed";t?(e="skipped",$("#wizardStepLabel"+n+" i").removeClass("fa-check-circle").addClass("fa-minus-circle")):(a.find(".signup-frm").hide(),a.find(".signup-frm-success").removeClass("hidden"),3==n?a.find(".signup-frm-success").append('<input type="hidden" id="ccGatewayFormSubmitted" name="ccGatewayFormSubmitted" value="1" />'):5==n&&a.find(".signup-frm-success").append('<input type="hidden" id="enomFormSubmitted" name="enomFormSubmitted" value="1" />')),0<i?$("#btnWizardBack").is(":visible")||$("#btnWizardBack").hide().removeClass("hidden").fadeIn("slow"):($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").fadeOut("slow")),$("#wizardStepLabel"+n).removeClass("current").addClass(e),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+i+" :input").removeAttr("disabled"),$("#wizardStep"+i).fadeIn(),$("#inputWizardStep").val(i),$("#wizardStepLabel"+i).addClass("current")}),$("#wizardStep"+(i+1)).length||($("#btnWizardSkip").fadeOut("slow"),$("#btnWizardBack").fadeOut("slow"),$(".modal-submit").html("Finish"))):$("#modalAjax").modal("hide")}function wizardStepBackTransition(){var e=$(".modal-wizard .wizard-step:visible").data("step-number"),t=parseInt(e)-1;$("#wizardStep"+e).fadeOut("",function(){trackWizardPageView(t),t<1&&($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").addClass("hidden")),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+t+" :input").removeAttr("disabled"),$("#wizardStep"+t).fadeIn(),$("#inputWizardStep").val(t),$("#wizardStepLabel"+t).addClass("current"),$("#wizardStepLabel"+e).removeClass("current")})}function fadeoutLoaderAndAllowSubmission(e){e.find(".loader").fadeOut(),e.find(".modal-submit").removeProp("disabled")}function addInvoicePayment(){addingPayment=!0,jQuery("#modalDuplicateTransaction").modal("hide"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/billing/invoice/"+thisInvoiceId+"/add-payment"),jQuery("#addPayment").serialize()).done(function(e){e.redirectUri&&(window.location=e.redirectUri)})}function cancelAddPayment(){jQuery("#paymentLoading").fadeOut("fast",function(){jQuery("#paymentText").fadeIn("fast"),jQuery("#btnAddPayment").removeAttr("disabled")}),jQuery("#modalDuplicateTransaction").modal("hide")}function openFeatureHighlights(){openModal("whatsnew.php?modal=1","","What's new in Version ...","","modal-feature-highlights","","","",!0)}function autoSubmitFormByContainer(e){"undefined"!=typeof noAutoSubmit&&!1!==noAutoSubmit||jQuery("#"+e).find("form:first").submit()}function slugify(e){for(var t="āæåãàáäâảẩấćčçđẽèéëêếēėęīįìíïîłńñœøōõòóöôốớơśšūùúüûưÿžźż·/_,:;–",n=0,a=t.length;n<a;n++)e=e.replace(new RegExp(t.charAt(n),"g"),"aaaaaaaaaaacccdeeeeeeeeeiiiiiilnnooooooooooossuuuuuuyzzz-------".charAt(n));return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}function generateBootstrapSwitches(){jQuery(".slide-toggle").bootstrapSwitch(),jQuery(".slide-toggle-mini").bootstrapSwitch({size:"mini"})}function submitForm(e,t){e=jQuery("#"+e);t?e.attr("target","_blank"):e.removeAttr("target"),e.submit()}function reverseCommissionConfirm(e,t){var n,a=jQuery("form#transactions"),i=a.serializeArray();if((n=i.find(function(e){return"amount"===e.name}).value)||(i=i.find(function(e){return"transid"===e.name}).value,n=jQuery('form#transactions select#transid option[value="'+i+'"]').data("amount")),t+n<e)return jQuery("#modalReverseAffiliateCommission").modal().show(),!1;jQuery("<input>",{type:"hidden",name:"reverseCommission",value:"true"}).appendTo(a),a.removeAttr("onsubmit").submit()}function reverseCommissionSubmit(e=!1){var t=jQuery("form#transactions");e&&jQuery("<input>",{type:"hidden",name:"reverseCommission",value:"true"}).appendTo(t),t.removeAttr("onsubmit").submit()}function autosizeTextarea(e){function t(){this.style.height="auto",this.style.height=n(this)}for(var n=function(e){return e.scrollHeight+parseFloat(jQuery(e).css("borderTopWidth"))+parseFloat(jQuery(e).css("borderBottomWidth"))+"px"},a=document.querySelectorAll(e),i=0;i<a.length;i++)a[i].style.overflowX="hidden",a[i].style.height=n(a[i]),a[i].addEventListener("input",t)}function calculateInvoiceTotal(e,t){return WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/invoice-total/calculate"),{invoiceId:e,items:t,token:csrfToken})}function destroyInvoiceItem(e){return WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/invoice-item/destroy"),{invoiceItemId:e,token:csrfToken})}function getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}function getWizardStepPageData(e){return{1:{title:"General",path:"/getting-started"},2:{title:"Payments",path:"/getting-started/payments/step1"},3:{title:"Domain",path:"/getting-started/domains/step1"},4:{title:"eNom",path:"/getting-started/enom"},5:{title:"Web Hosting",path:"/getting-started/hosting"},6:{title:"Add-ons & Extras",path:"/getting-started/marketConnect/step1"},7:{title:"Complete",path:"/getting-started/complete"}}[e]||{title:"Unknown step",path:"/getting-started/unknown"}}function isMixpanelEnabled(){return"undefined"!=typeof mixpanel_enabled&&!0===mixpanel_enabled}function trackWizardPageView(e,t="view"){var n;isMixpanelEnabled()&&(e=getWizardStepPageData(e),n=this.getFullUrl(e.path),mixpanel.track_pageview({page:e.title+` (${t})`,$current_url:n,$referrer:n}))}function trackWizardAction(e,t){var n;isMixpanelEnabled()&&(e=getWizardStepPageData(e),n=this.getFullUrl(e.path),mixpanel.track(e.title+` (${t})`,{$current_url:n}))}function getFullUrl(e){return new URL(e,window.location.origin).toString()}var grid,packery,ajaxModalSubmitEvents=[],ajaxModalPostSubmitEvents=[];function openModal(e,t,n,a,i,r,o,s,d,l){jQuery("#modalAjax .modal-title").html(n),a&&jQuery("#modalAjax").children('div[class="modal-dialog"]').addClass(a),i&&jQuery("#modalAjax").addClass(i),r?(jQuery("#modalAjax .modal-submit").show().html(r),o&&jQuery("#modalAjax .modal-submit").attr("id",o)):jQuery("#modalAjax .modal-submit").hide(),d&&jQuery("#modalAjaxClose").hide(),s&&jQuery("#modalAjax .modal-submit").removeClass("btn-primary").addClass("btn-"+s),jQuery("#modalAjax .modal-body").html(""),jQuery("#modalSkip").hide(),disableSubmit(),jQuery("#modalAjax").modal({show:!0,keyboard:!0,backdrop:!jQuery("#modalAjax").hasClass("static")||"static"}),WHMCS.http.jqClient.post(e,t,function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()}).always(function(){var e=jQuery("#modalAjax").find("form"),e=(o&&e.submit(function(e){return submitIdAjaxModalClickEvent(),!1}),l&&e.data("successDataTable",l),jQuery(e).find("input:not(input[type=checkbox],input[type=radio],input[type=hidden])"));0<e.length&&jQuery(e).first().focus()}),o&&((n=jQuery("#"+o)).off("click"),n.on("click",submitIdAjaxModalClickEvent))}function submitIdAjaxModalClickEvent(){var a,n,i,r=!0,e=jQuery("#modalAjax .loader");disableSubmit(),e.show(),ajaxModalSubmitEvents.length&&jQuery.each(ajaxModalSubmitEvents,function(e,t){t=window[t];r&&"function"==typeof t&&(r=t())}),r?(a=jQuery("#modalAjax").find("form"),n=jQuery("#modalAjax .modal-body"),i=jQuery(n).find(".admin-modal-error"),jQuery(i).slideUp(),WHMCS.http.jqClient.post(a.attr("action"),a.serialize(),function(n){a.data("successDataTable")&&(n.successDataTable=a.data("successDataTable")),ajaxModalPostSubmitEvents.length&&jQuery.each(ajaxModalPostSubmitEvents,function(e,t){t=window[t];"function"==typeof t&&t(n,a)}),updateAjaxModal(n)},"json").fail(function(e){var e=e.responseJSON,t="An error occurred while communicating with the server. Please try again.";e&&e.data?(e=e.data).errorMsg?0<i.length?jQuery(i).html(e.errorMsg).slideDown():jQuery.growl.warning({title:e.errorMsgTitle,message:e.errorMsg}):e.data.body?jQuery(n).html(e.body):jQuery(n).html(t):jQuery(n).html(t),jQuery("#modalAjax .loader").fadeOut(),enableSubmit()})):(enableSubmit(),e.hide())}function updateAjaxModal(e){var t;e.reloadPage?"string"==typeof e.reloadPage?window.location=e.reloadPage:window.location.reload():(e.successDataTable&&WHMCS.ui.dataTable.getTableById(e.successDataTable,void 0).ajax.reload(),e.redirect&&(window.location=e.redirect),e.successWindow&&"function"==typeof window[e.successWindow]&&window[e.successWindow](),e.dismiss&&dialogClose(),e.successMsg&&jQuery.growl.notice({title:e.successMsgTitle,message:e.successMsg}),e.errorMsg&&(0<(t=jQuery("#modalAjax .modal-body .admin-modal-error")).length&&!e.dismiss?jQuery(t).html(e.errorMsg).slideDown():jQuery.growl.warning({title:e.errorMsgTitle,message:e.errorMsg})),e.title&&jQuery("#modalAjax .modal-title").html(e.title),e.body?jQuery("#modalAjax .modal-body").html(e.body):e.url&&WHMCS.http.jqClient.post(e.url,"",function(e){jQuery("#modalAjax").find(".modal-body").html(e.body)},"json").fail(function(){jQuery("#modalAjax").find(".modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax").find(".loader").fadeOut()}),e.submitlabel&&(jQuery("#modalAjax .modal-submit").html(e.submitlabel).show(),e.submitId)&&jQuery("#modalAjax").find(".modal-submit").attr("id",e.submitId),e.submitId&&((t=jQuery("#"+e.submitId)).off("click"),t.on("click",submitIdAjaxModalClickEvent)),(e.disableSubmit?disableSubmit:enableSubmit)(),t=!0,dismissLoaderAfterRender(t=void 0!==e.dismissLoader?e.dismissLoader:t),e.hideSubmit&&ajaxModalHideSubmit())}function dialogSubmit(){disableSubmit(),jQuery("#modalAjax .loader").show();var e=jQuery("#modalAjax").find("form").attr("action");WHMCS.http.jqClient.post(e,jQuery("#modalAjax").find("form").serialize(),function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}function dialogClose(){jQuery("#modalAjax").modal("hide")}function addAjaxModalSubmitEvents(e){e&&ajaxModalSubmitEvents.push(e)}function removeAjaxModalSubmitEvents(e){e&&0<=(e=ajaxModalSubmitEvents.indexOf(e))&&ajaxModalSubmitEvents.splice(e,1)}function addAjaxModalPostSubmitEvents(e){e&&ajaxModalPostSubmitEvents.push(e)}function removeAjaxModalPostSubmitEvents(e){e&&0<=(e=ajaxModalPostSubmitEvents.indexOf(e))&&ajaxModalPostSubmitEvents.splice(e,1)}function disableSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!0).addClass("disabled")}function enableSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!1).removeClass("disabled")}function ajaxModalHideSubmit(){jQuery("#modalAjax .modal-submit").hide()}function dismissLoaderAfterRender(e){!1===e?jQuery("#modalAjax .loader").show():jQuery("#modalAjax .loader").fadeOut()}function refreshWidget(e,t){var n=$('.panel[data-widget="'+e+'"]'),a=n.find(".panel-body"),i=n.find("i.fa-sync");a.addClass("panel-loading"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/refresh&widget="+e+"&"+t),{token:csrfToken},function(e){a.html(e.widgetOutput),a.removeClass("panel-loading")},"json").always(function(){i.removeClass("fa-spin")})}function loadAutomationStatsForDate(e){$("#statsContainer").css("opacity","0.5"),WHMCS.http.jqClient.post("automationstatus.php","action=stats&date="+e,function(e){$(".widgets-container").html(e.body),$(".day-selector").find(".btn-viewing").html(e.newDate)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#statsContainer").css("opacity","1")})}function refreshGraph(){$("#graphContainer").css("opacity","0.5");WHMCS.http.jqClient.post("automationstatus.php","action=graph&metric="+$(".graph-filter-metric a.active").attr("href")+"&period="+$(".graph-filter-period a.active").attr("href"),function(e){$("#graphContainer").html(e.body)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#graphContainer").css("opacity","1")})}function initDateRangePicker(){jQuery(document).ready(function(){jQuery(".date-picker-search").each(function(e){var t=jQuery(this),n=t.data("opens"),a=t.data("drops"),i=adminJsVars.dateRangePicker.defaultRanges,r=adminJsVars.dateRangeFormat;n&&void 0!==n||(n="center"),a&&void 0!==a||(a="down"),t.hasClass("future")&&(i=adminJsVars.dateRangePicker.futureRanges),t.daterangepicker({autoUpdateInput:!1,ranges:i,alwaysShowCalendars:!0,opens:n,drops:a,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,locale:{format:r,applyLabel:adminJsVars.dateRangePicker.applyLabel,cancelLabel:adminJsVars.dateRangePicker.cancelLabel,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("show.daterangepicker",function(e,t){""!=t.element[0].id&&(t.container[0].id="dateRangePicker_"+t.element[0].id)}).on("apply.daterangepicker",function(e,t){jQuery(this).val(t.startDate.format(adminJsVars.dateRangeFormat)+" - "+t.endDate.format(adminJsVars.dateRangeFormat))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val("")})}),jQuery(".datepick,.date-picker,.date-picker-single").each(function(e){var t=jQuery(this),n=t.data("opens"),a=t.data("drops"),i=adminJsVars.dateRangePicker.defaultSingleRanges,r=adminJsVars.dateRangeFormat,o=!1;n&&void 0!==n||(n="center"),a&&void 0!==a||(a="down"),t.hasClass("future")&&(i=adminJsVars.dateRangePicker.futureSingleRanges),t.hasClass("time")&&(o=!0,r=adminJsVars.dateTimeRangeFormat,t.hasClass("future"))&&(i=adminJsVars.dateRangePicker.futureTimeSingleRanges),t.daterangepicker({singleDatePicker:!0,autoUpdateInput:!1,ranges:i,alwaysShowCalendars:!0,opens:n,drops:a,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,timePicker:o,timePickerSeconds:!1,locale:{format:r,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("show.daterangepicker",function(e,t){""!=t.element[0].id&&(t.container[0].id="dateRangePicker_"+t.element[0].id)}).on("apply.daterangepicker",function(e,t){jQuery(this).data("original-value",t.startDate.format(r)).val(t.startDate.format(r))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val(jQuery(this).data("original-value"))})})})}jQuery(document).ready(function(){jQuery(document).on("click",".open-modal",function(e){e.preventDefault();var e=jQuery(this).attr("href"),t=jQuery(this).data("modal-size"),n=jQuery(this).data("modal-class"),a=jQuery(this).data("modal-title"),i=jQuery(this).data("btn-submit-id"),r=jQuery(this).data("btn-submit-label"),o=jQuery(this).data("btn-submit-color"),s=jQuery(this).data("btn-close-hide"),d=jQuery(this).attr("disabled"),l=jQuery(this).data("datatable-reload-success"),u="";csrfToken&&(u={token:csrfToken}),d||openModal(e,u,a,t,n,r,i,o,s,l)}),jQuery("#modalAjax").on("hidden.bs.modal",function(e){var t;jQuery(this).hasClass("modal-feature-highlights")&&(t=jQuery("#cbFeatureHighlightsDismissForVersion").is(":checked"),WHMCS.http.jqClient.post("whatsnew.php",{dismiss:"1",until_next_update:t?"1":"0",token:csrfToken})),jQuery("#modalAjax").find(".modal-body").empty(),jQuery("#modalAjax").children("div.modal-dialog").removeClass("modal-lg"),jQuery("#modalAjax").removeClass().addClass("modal whmcs-modal fade"),jQuery("#modalAjax .modal-title").html("Title"),jQuery("#modalAjax .modal-submit").html("Submit").removeClass().addClass("btn btn-primary modal-submit").removeAttr("id").removeAttr("disabled"),jQuery("#modalAjax .loader").show()})}),jQuery(document).ready(function(){var e=jQuery(".selectize-multi-select"),t=jQuery(".selectize-select"),n=jQuery(".selectize-promo"),a=jQuery(".selectize-tags"),i=jQuery(".selectize-newTicketCc,.selectize-ticketCc");jQuery(e).selectize({plugins:["remove_button"],valueField:jQuery(e).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:!0,create:!1,maxItems:null,render:{item:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"}},onItemRemove:function(e){"multi-view"==jQuery(this)[0].$input[0].id&&"any"!=e&&"flagged"!=e&&jQuery(this)[0].removeItem("any",!0)}}),jQuery(t).selectize({valueField:jQuery(t).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(t).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var n="";return"<div"+(n=void 0!==e.colour&&"#FFF"!==e.colour?' style="background-color: '+t(e.colour)+';"':n)+'><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){var n="";return"<div"+(n=void 0!==e.colour&&"#FFF"!==e.colour?' style="background-color: '+t(e.colour)+';"':n)+'><span class="name">'+t(e.name)+"</span></div>"}},onInitialize:function(){this.currentValue=""},onFocus:function(){this.currentValue=this.getValue(),this.clear()},onChange:function(){""!==this.getValue()&&this.currentValue!==this.getValue()&&(this.currentValue=this.getValue(),jQuery(t).hasClass("selectize-auto-submit"))&&jQuery(t).parent("form").submit()},onBlur:function(){this.setValue(this.currentValue)}}),jQuery(n).selectize({valueField:jQuery(n).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(n).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var n="",a=e.name.split(" - ");return void 0!==e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(n=' style="background-color: '+t(e.colour)+';"'),"undefined"!=typeof otherPromos&&e.optgroup===otherPromos&&""!==this.currentValue?jQuery("#nonApplicablePromoWarning").show():jQuery("#nonApplicablePromoWarning").hide(),a[1]?"<div"+n+"><strong>"+t(a[0])+'</strong><small style="overflow: hidden"> - '+t(a[1])+"</small></div>":"<div"+n+">"+t(a[0])+"</div>"},option:function(e,t){var n="",a=e.name.split(" - ");return void 0!==e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(n=' style="background-color: '+t(e.colour)+';"'),a[1]?"<div"+n+"><strong>"+t(a[0])+"</strong><br />"+t(a[1])+"</div>":"<div"+n+">"+t(a[0])+"</div>"}},onInitialize:function(){this.currentValue=""},onFocus:function(){this.$control.parent("div").css("overflow","visible"),this.currentValue=this.getValue(),this.clear()},onChange:function(){""!==this.getValue()&&this.currentValue!==this.getValue()&&(this.currentValue=this.getValue(),jQuery(n).hasClass("selectize-auto-submit"))&&jQuery(n).parent("form").submit()},onBlur:function(){this.$control.parent("div").css("overflow","hidden"),this.setValue(this.currentValue)}}),jQuery(a).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!1,create:function(e){return{value:e,text:e}},render:{item:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"},option:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"}},load:function(e,t){if(!e.length)return t();jQuery.ajax({url:window.location.href,type:"POST",dataType:"json",data:{action:"gettags",q:e,token:csrfToken},error:function(){t()},success:function(e){t(e)}})},onItemAdd:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"addTag",newTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})},onItemRemove:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"removeTag",removeTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})}}),jQuery(i).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!0,create:function(e){return{value:e=e.toLowerCase(),text:e,name:e,iconclass:""}},render:{item:function(e,t){return'<div class="selectize"><span class="name">'+(void 0!==e.iconclass&&0<e.iconclass.length?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name))+"</span></div>"},option:function(e,t){return'<div class="selectize"><span class="name">'+(void 0!==e.iconclass&&0<e.iconclass.length?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name))+'</span><span class="email">'+t(e.text)+"</span></div>"}}})}),$(document).ready(function(){var a=null,i=(a=(a="undefined"!=typeof Storage?JSON.parse(localStorage.getItem("minimisedWidgets")):a)||[],$(".widget-minimise").click(function(e){e.preventDefault();var e=$(this),t=e.find("i"),n=e.closest(".panel").data("widget");t.hasClass("fa-chevron-up")?(e.closest(".panel").find(".panel-body").slideUp("fast",function(){t.removeClass("fa-chevron-up").addClass("fa-chevron-down"),packery.shiftLayout()}),-1==a.indexOf(n)&&a.push(n)):(e.closest(".panel").find(".panel-body").slideDown("fast",function(e){t.removeClass("fa-chevron-down").addClass("fa-chevron-up"),packery.fit(this),packery.shiftLayout()}),a.splice(a.indexOf(n),1)),"undefined"!=typeof Storage&&localStorage.setItem("minimisedWidgets",JSON.stringify(a))}),$(".widget-refresh").click(function(e){e.preventDefault();var e=$(this),t=e.find("i"),n=e.closest(".panel").data("widget");e.closest(".panel").find(".panel-body");t.addClass("fa-spin"),refreshWidget(n,"refresh=1")}),!1);if($(".widget-hide").click(function(e){e.preventDefault();var t=$(this).closest(".panel").data("widget");i=!0,$("#panel"+t).slideUp("fast",function(){$(this).addClass("hidden"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+t)).always(function(){$('input[data-widget="'+t+'"]').iCheck("uncheck"),i=!1}),$(".home-widgets-container").masonry().masonry("reloadItems")})}),$(document).on("ifToggled",".display-widget",function(e){var t=$(this),n=$(this).data("widget"),a=$("#panel"+n);i||(t.iCheck("disable"),t.prop("checked")?a.hasClass("hidden")&&(t.parent("div").parent("label").parent("li").addClass("active"),a.hide().removeClass("hidden").slideDown("fast",function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+n)).always(function(){$(".home-widgets-container").masonry().masonry("reloadItems"),a.find(".widget-refresh").click(),!1===$("#widgetSettingsDropdown").hasClass("open")&&$("#widgetSettings").dropdown("toggle"),t.iCheck("enable")})})):!1===a.hasClass("hidden")&&(t.parent("div").parent("label").parent("li").removeClass("active"),a.slideUp("fast",function(){$(this).addClass("hidden"),$(".home-widgets-container").masonry().masonry("reloadItems"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+n),function(){!1===$("#widgetSettingsDropdown").hasClass("open")&&$("#widgetSettings").dropdown("toggle")},"json").always(function(){t.iCheck("enable")})})))}),$("input.display-widget").each(function(){var e=$(this),t=e.next();t.text();t.remove(),e.iCheck({inheritID:!0,checkboxClass:"icheckbox_flat-blue",increaseArea:"20%"})}),$(".home-widgets-container").length){a.forEach(function(e){$("#panel"+e).find(".panel-body").hide().end().find("i.fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")}),Packery.prototype.getPositions=function(){return this.items.map(function(e){return e.element.getAttribute("data-widget")})},grid=document.querySelector(".home-widgets-container"),(packery=new Packery(grid,{itemSelector:".dashboard-panel-item",columnWidth:".dashboard-panel-sizer",percentPosition:!0})).stamp(document.querySelector(".dashboard-panel-static-item"));for(var e=grid.querySelectorAll(".dashboard-panel-item"),t=0;t<e.length;t++){var n=e[t],n=new Draggabilly(n,{handle:".panel-title"});packery.bindDraggabillyEvents(n)}packery.on("removeComplete",function(){packery.shiftLayout()});var r=!1;packery.on("dragItemPositioned",function(e){packery.shiftLayout(),$(".home-widgets-container").children("div.dashboard-panel-item").hasClass("is-dragging")||r||(r=!0,setTimeout(function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/order"),{token:csrfToken,order:packery.getPositions()},function(e){},"json").always(function(){r=!1,packery.shiftLayout()})},1e3))})}function o(){var e=jQuery(this),t=e.closest(".item");return t.hasClass("active")?e.outerHeight():(t.addClass("active"),e=e.outerHeight(),t.removeClass("active"),e)}jQuery(".admin-dashboard-carousel button.close").on("click",function(){var e=jQuery(this).closest(".alert").data("identifier"),t=jQuery(".admin-dashboard-carousel");t.find(".item").length<=1?t.remove():function(e,a){let i=e.find(".item"),t=e.find(".carousel-indicators li"),r=0;if(i.removeClass("active"),i.each(function(t,n){if(0<jQuery(n).find('[data-identifier="'+a+'"]').length){let e=parseInt(t)+1;e>=i.length&&(e=0),r=e,jQuery(n).remove(),jQuery(i[e]).addClass("active")}}),i.length<=2)return jQuery(".admin-dashboard-carousel-controls").remove();0!==r&&r--;t.removeClass("active"),t.each(function(e,t){e===r&&jQuery(t).addClass("active")}),t.last().remove()}(t,e);WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/promotions/dismiss/"+e),{token:csrfToken})}),jQuery(window).on("load resize orientationchange",function(){var e=jQuery(".admin-dashboard-carousel .promotion-content"),t=(e.css("min-height",0),Math.max.apply(null,e.map(o).get()));e.css("min-height",t+"px")})}),jQuery(document).ready(function(){let e=jQuery("#mixpanelOptInModal");var t=jQuery(".whmcs-modal.modal-setup-wizard.in"),n=document.querySelector("[data-user-id]"),n=n?n.getAttribute("data-user-id"):null;if(n&&-1===document.cookie.indexOf(`trackingOptInDismissed_${n}=true;`)&&!t.length){e.addClass("mixpanel-shown");const i=new MutationObserver(()=>{jQuery(".whmcs-modal.modal-setup-wizard.in").length&&(a(!1),i.disconnect())}),r=(i.observe(document.body,{childList:!0,subtree:!0}),jQuery("#optInAccept").on("click",function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/mixpanel/config/set"),{token:csrfToken,MixPanelTrackingEnabled:!0}),a(!1),jQuery("#optInAccept").hide(),i.disconnect()}),jQuery("#optInDismiss").on("click",function(){a(!0),jQuery("#optInDismiss").hide(),i.disconnect()}),jQuery("#optInClose").on("click",function(){a(!1),i.disconnect()}),document.querySelector("input[name='mixpaneltrackingenabled']"));n=document.querySelector('input[type="submit"].btn.btn-primary');if(r&&n){let e=r.checked;n.addEventListener("click",function(){e&&!r.checked&&a(!1)})}}function a(t){e.removeClass("mixpanel-shown");var n=window.location.pathname.split("/")[1]||"",a=document.querySelector("input.adminUserId")||document.getElementById("mixpanelOptInModal"),a=a&&a.hasAttribute("data-user-id")?a.getAttribute("data-user-id"):null;if(a){let e=`trackingOptInDismissed_${a}=true; path=/${n}; SameSite=Lax`;"https:"===window.location.protocol&&(e+="; Secure"),t&&(e+="; max-age=31536000"),document.cookie=e}}}),$(document).ready(function(){$("#statsContainer").on("click",".btn-viewing",function(e){e.preventDefault()}),$("#graphContainer").on("click",".graph-filter-metric a",function(e){e.preventDefault(),$(".graph-filter-metric a").removeClass("active"),$(this).addClass("active"),refreshGraph()}),$("#graphContainer").on("click",".graph-filter-period a",function(e){e.preventDefault(),$(".graph-filter-period a").removeClass("active"),$(this).addClass("active"),refreshGraph()})}),jQuery(document).ready(function(){var e=jQuery(".database-backups");e.find(".activate").on("click",function(){var t=jQuery(this),n=t.parent("form"),a=t.data("type"),e=n.serialize();t.prop("disabled",!0).addClass("disabled"),e+="&action=save&activate=1&type="+a+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,e,function(e){!0===e.success?(jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}),n.find(".save, .deactivate-start").removeClass("hidden"),t.addClass("hidden"),jQuery("#"+a+"Label").toggleClass("label-default label-success").text(e.activeText)):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){t.prop("disabled",!1).removeClass("disabled")})}),e.find(".save").on("click",function(){var e=jQuery(this),t=e.parent("form"),n=e.data("type"),t=t.serialize();e.prop("disabled",!0).addClass("disabled"),t+="&action=save&type="+n+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,t,function(e){!0===e.success?jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled")})}),e.find(".test").on("click",function(){var e=jQuery(this),t=e.parent("form"),n=e.data("type"),a=t.serialize();e.prop("disabled",!0).addClass("disabled"),jQuery("#"+n+"Container").removeClass("hidden"),a+="&action=test&type="+n+"&token="+csrfToken,jQuery("#"+n+"Test").hide().removeClass("hidden alert-success alert-danger").addClass("alert-default").find(".extra-text").addClass("hidden").text("").end().find(".default-text").removeClass("hidden").end().slideDown("fast"),WHMCS.http.jqClient.post(window.location.href,a,function(e){!0===e.success?(jQuery("#"+n+"Test").addClass("alert-success").removeClass("alert-default alert-danger").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.successMessage).removeClass("hidden").end().delay(3e3).slideUp("slow"),t.find(".activate").prop("disabled",!1).removeClass("disabled")):jQuery("#"+n+"Test").addClass("alert-danger").removeClass("alert-default alert-success").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.errorMessageTitle+": "+e.errorMessage).removeClass("hidden").end().delay(3e3).slideUp("slow")},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),jQuery("#"+n+"Container").addClass("hidden")})}),e.find(".deactivate-start").on("click",function(){var e=jQuery(this),e=(e.parent("form"),e.data("type")),t=jQuery("#modalConfirmDeactivate");jQuery("#confirmDeactivateYes").data("type",e),t.modal("show")}),jQuery("#modalConfirmDeactivate").find(".deactivate").on("click",function(){var e=jQuery(this),t=jQuery("#modalConfirmDeactivate"),n=(t.parent("form"),e.data("type")),a="action=deactivate&type="+n+"&token="+csrfToken,i=jQuery('.deactivate-start[data-type="'+n+'"]').parent("form");e.prop("disabled",!0).addClass("disabled"),WHMCS.http.jqClient.post(window.location.href,a,function(e){!0===e.success?(jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}),i.find(".save, .deactivate-start").addClass("hidden"),i.find(".activate").removeClass("hidden").prop("disabled",!0),"email"===n&&i.find(".activate").prop("disabled",!1),jQuery("#"+n+"Label").toggleClass("label-default label-success").text(e.inactiveText)):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),t.modal("hide")})}),e.find("#inputDestination").on("change",function(){var e=jQuery("#destinationData"),t=jQuery(this).val();"homedir"!==t&&e.hasClass("hidden")?e.hide().removeClass("hidden").slideDown("fast"):"homedir"!==t||e.hasClass("hidden")||e.slideUp("fast").addClass("hidden")})}),initDateRangePicker(),jQuery(document).ready(function(){var i,r,o,t=jQuery("button.retry-all");function n(){if(i){var e=jQuery("button.retry:eq("+o+")");if(!e.length)return clearTimeout(r),r=null,void t.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end();e.click()}r=setTimeout(n,1e3)}t.length&&(i=!1,r=null,o=0,jQuery("button.retry").click(function(){i=!1;var t=jQuery(this),n=jQuery(this).data("entry-id"),a=jQuery("div#processing-entry-"+n),e=(t.attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end(),r?a.find("div.queued").hide().end().find("div.processing").show().end():a.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast"),WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"retry",id:n},null,"json"));e.done(function(e){e.error&&(a.find("div.processing").hide().end().find("div.error").find("span").html(e.message).parent().show().end(),jQuery("#last-error-"+n).html(e.errorMessage),jQuery("div#entry-"+n).find("small.last-attempt").find("span").html(e.lastAttempt),t.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end(),o++),e.completed&&(jQuery("div#entry-"+n).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").find("i.fa-spin").removeClass("fa-spin").end(),a.find("div.processing").slideUp("fast").end().find("div.success").slideDown("fast").end())}),e.always(function(){i=!0})}),jQuery("button.resolve").click(function(){var t=jQuery(this),n=jQuery(this).data("entry-id"),a=jQuery("div#processing-entry-"+n);t.attr("disabled","disabled").addClass("disabled"),a.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast"),WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"resolve",id:n},null,"json").done(function(e){e.completed?(jQuery("div#entry-"+n).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").end(),a.find("div.processing").slideUp("fast").end().find("div.success").find("span").html(e.message).parent().slideDown("fast").end()):(a.find("div.processing").slideUp("fast").end().find("div.error").find("span").html(e.message).parent().slideDown("fast").end(),t.removeAttr("disabled").removeClass("disabled"))})}),t.click(function(){jQuery(this).attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end();var e=jQuery("button.retry");i=!0,o=0,e.each(function(e){var t=jQuery(this).data("entry-id");jQuery("div#processing-entry-"+t).find("div.messages").children("div").hide().end().find("div.queued").show().end().end().hide().removeClass("hidden").slideDown("fast")}),r=setTimeout(n,1e3)}))}),jQuery(document).ready(function(){jQuery(document).on("click","#btnMcServiceRefresh",function(e){e.preventDefault();var t=$(this);t.find("i").addClass("fa-spin"),WHMCS.http.jqClient.post({url:"clientsservices.php",data:t.attr("href")+"&token="+csrfToken,success:function(e){$("#mcServiceManagementWrapper").replaceWith(e.statusOutput),t.find("i").removeClass("fa-spin")}})}),jQuery(document).on("click","#btnMcCancelOrder",function(e){swal({title:"Are you sure?",html:!0,text:'Cancelling this order will result in the service immediately ceasing to function.<br><br>You will automatically receive a credit if within the credit period. <a href="https://go.whmcs.com/1281/marketconnect-credit-terms" target="_blank">See credit period terms</a>',type:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it",cancelButtonText:"No"},function(){runModuleCommand("terminate")})}),jQuery(document).on("click","#mcServiceManagementWrapper .btn:not(.open-modal,.btn-refresh,.btn-cancel)",function(e){e.preventDefault(),$("#growls").fadeOut("fast").remove(),$(".successbox,.errorbox").slideUp("fast").remove();var e=$(this),t=e.attr("href"),n=e.find("i"),a=n.attr("class");"disabled"!==e.attr("disabled")&&(n.removeClass().addClass("fas fa-spin fa-spinner"),WHMCS.http.jqClient.post("clientsservices.php",t+"&token="+csrfToken,function(e){e.redirectUrl?window.open(e.redirectUrl):e.growl?"error"==e.growl.type?$.growl.error({title:"",message:e.growl.message}):($.growl.notice({title:"",message:e.growl.message}),$("#btnMcServiceRefresh").click()):($.growl.error({title:"",message:"Unknown response"}),console.error("[WHMCS] Unknown response: "+JSON.stringify(e)))},"json").fail(function(e){e=""!=e.responseText?e.responseText:e.statusText;$.growl.error({title:"",message:e})}).always(function(e){n.removeClass().addClass(a)}))}).on("click",".feature-menu-item",function(e){e.preventDefault();var e=jQuery(this),t=e.data("name"),n=jQuery(".feature-menu-item.shown"),a=jQuery(".feature-info-item.shown"),i=jQuery('.feature-info-item[data-name="'+t+'"]');n.removeClass("shown"),e.addClass("shown"),a.slideUp("fast",function(){jQuery(this).removeClass("shown"),i.hide().addClass("shown").slideDown("fast")})})}),jQuery(document).ready(function(){const t=new Map([["um","us"],["ic","es"],["gs","fk"],["aq","nf"],["tf","re"],["hm","nf"],["an","bq"],["pn","nz"]]);function o(e){return e=e.toLowerCase(),t.has(e)?t.get(e):e}if("undefined"!=typeof customCountryData){var e,n=$.fn.intlTelInput.getCountryData();for(e in customCountryData)if(customCountryData.hasOwnProperty(e)){var a=customCountryData[e];if(codeLower=e.toLowerCase(),!1===a){for(var i=0;i<n.length;i++)if(codeLower===n[i].iso2){n.splice(i,1);break}}else n.push({name:a.name,iso2:codeLower,dialCode:a.callingCode,priority:0,areaCodes:null})}}var r,s,d,l;jQuery("body").data("phone-cc-input")&&((r=jQuery('input[name^="phone"], input[name$="phone"], input[name="domaincontactphonenumber"]').not('input[type="hidden"]')).length&&(s=jQuery('[name^="country"], [name$="country"]'),d="us",s.length&&(d=o(s.val())),r.each(function(){var t=jQuery(this),n=t.attr("name");"domaincontactphonenumber"===n&&(d=jQuery('[name="domaincontactcountry"]').val().toLowerCase()),jQuery(this).before('<input id="populatedCountryCode'+n+'" type="hidden" name="country-calling-code-'+n+'" value="" />');try{t.intlTelInput({preferredCountries:[d,"us","gb"].filter(function(e,t,n){return n.indexOf(e)===t}),initialCountry:d,autoPlaceholder:"polite",separateDialCode:!0})}catch(e){return console.log(e.message),!1}t.on("countrychange",function(e,t){jQuery("#populatedCountryCode"+n).val(t.dialCode),jQuery(this).val()==="+"+t.dialCode&&jQuery(this).val("")}),t.on("blur keydown",function(e){var t;("blur"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e=jQuery(this).intlTelInput("getNumber"),t="+"+jQuery(this).intlTelInput("getSelectedCountryData").dialCode,0===e.indexOf(t)&&1<(e.match(/\+/g)||[]).length&&(e=e.substr(t.length)),jQuery(this).intlTelInput("setNumber",e))}),jQuery("#populatedCountryCode"+n).val(t.intlTelInput("getSelectedCountryData").dialCode),s.on("change",function(){if(""===t.val()){var e=o(jQuery(this).val());try{r.intlTelInput("setCountry",e)}catch(e){return console.log(e.message),!1}}}),t.attr("data-initial-value",$(t).val()),t.parents("form").find("input[type=reset]").each(function(){var t=$(this).parents("form");$(this).data("phone-handler")||($(this).data("phone-handler",!0),$(this).click(function(e){return e.stopPropagation(),$(t).trigger("reset"),$(t).find("input[data-initial-value]").each(function(){$(this).val($(this).attr("data-initial-value"))}),!1}))})}),r.parents("div.form-group").find(".field-icon").hide().end(),r.removeClass("field").addClass("form-control")),(l=jQuery('input[name$="][Phone Number]"], input[name$="][Phone]"]').not('input[type="hidden"]')).length)&&jQuery.each(l,function(e,t){var n=jQuery(this),a=(a=n.attr("name")).replace("contactdetails[","").replace("][Phone Number]","").replace("][Phone]",""),i=jQuery('[name$="'+a+'][Country]"]'),r=o(i.val());n.before('<input id="populated'+a+'CountryCode" class="'+a+'customwhois" type="hidden" name="contactdetails['+a+'][Phone Country Code]" value="" />'),n.intlTelInput({preferredCountries:[r,"us","gb"].filter(function(e,t,n){return n.indexOf(e)===t}),initialCountry:r,autoPlaceholder:"polite",separateDialCode:!0}),n.on("countrychange",function(e,t){jQuery("#populated"+a+"CountryCode").val(t.dialCode),jQuery(this).val()==="+"+t.dialCode&&jQuery(this).val("")}),n.on("blur keydown",function(e){var t;("blur"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e=jQuery(this).intlTelInput("getNumber"),t="+"+jQuery(this).intlTelInput("getSelectedCountryData").dialCode,0===e.indexOf(t)&&1<(e.match(/\+/g)||[]).length&&(e=e.substr(t.length)),jQuery(this).intlTelInput("setNumber",e))}),jQuery("#populated"+a+"CountryCode").val(n.intlTelInput("getSelectedCountryData").dialCode),i.on("blur",function(){var e;""===n.val()&&(e=o(jQuery(this).val()),n.intlTelInput("setCountry",e))})})});